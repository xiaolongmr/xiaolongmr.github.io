<!DOCTYPE html>
<html lang="zh-cn">

<head>
    <meta charset=UTF-8>
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1" />
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-touch-fullscreen" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="è§†ä¼ å¯¼èˆªç«™">
    <title>å¤DJå¯¼èˆªç«™-å¾ˆæœ‰èŒƒçš„å¯¼èˆªç«™</title>
    <meta name="description" content="å¤§ä¸‰è§†ä¼ äººè‡ªåˆ¶ï¼Œæ–¹ä¾¿è‡ªå·±å·²ç»æœ‹å‹è€Œå­˜åœ¨çš„å¯¼èˆªç½‘ç«™å¤djå¯¼èˆª-è®¾è®¡å¸ˆå¿…å¤‡å¯¼èˆªç«™ã€‚">
    <meta name=keywords content="å¤dj,å¤djç«™,è§†ä¼ å¯¼èˆªç½‘,è®¾è®¡å¯¼èˆªç½‘,å¤DJå¯¼èˆª,å¤DJå¯¼èˆªç«™">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <meta name="apple-mobile-web-app-title" content="å¤DJå¯¼èˆª">
    <link rel="apple-touch-icon" href="/favicon.ico">
    <link rel="apple-touch-icon-precomposed" sizes="180x180" href="/favicon.ico">
    <link rel="apple-touch-icon" href="https://jsd.cdn.zzko.cn/gh/xiaolongmr/test@main/1.png">
    <link rel="apple-touch-icon-precomposed" sizes="180x180" href="./favicon.png">

    <!-- styleæœ¬åœ°æ–‡ä»¶å’Œå¤–é“¾ styleæ˜¯æœ¬åœ°æµ‹è¯•å¸¦æœ‰åµŒå¥—å…³ç³»çš„cssï¼Œ output.cssæ˜¯è§£æåµŒå¥—åçš„ -->
    <link rel=stylesheet href="css/style.css">
    <!-- <link rel=stylesheet href=css/output.css> -->
    <!-- <link rel="stylesheet" href="https://jsd.012700.xyz/gh/xiaolongmr/dh/css/style.css"> -->
    <!-- <link rel="stylesheet" href="https://cdn.h5ds.com/space/files/600972551685382144/20240714/736843635572895744.css"> -->
    <!-- end -->

    <!-- RSSæœç´¢ç»“æœæ ·å¼ -->
    <style>
        /* å¼ºåˆ¶è¦†ç›–ç½‘ç«™æ‰€æœ‰ç½‘æ ¼å¸ƒå±€ï¼Œç¡®ä¿RSSç»“æœæ˜¯å•åˆ—å¸ƒå±€ */
        .rss-wrapper {
            display: block !important;
            width: 100% !important;
            grid-column: 1 / -1 !important;
            clear: both !important;
            float: none !important;
            margin-top: 20px !important;
        }

        /* .rss-outer-container {
            width: 100% !important;
            clear: both !important;
            display: block !important;
            margin-top: 20px !important;
            padding-top: 15px !important;
            position: relative !important;
            float: none !important;
            border-top: 1px solid #dbe3f0 !important;
            background-color: rgba(210, 242, 255, 0.1) !important;
            padding: 15px !important;
            border-radius: 10px !important;
        } */

        /* RSSæœç´¢ç»“æœæ ‡é¢˜ */
        .rss-results-title {
            width: 100% !important;
            font-size: 16px !important;
            font-weight: bold !important;
            margin: 0 0 15px 0 !important;
            color: #3273dc !important;
            clear: both !important;
            display: block !important;
            padding-left: 8px !important;
        }

        /* RSSç»“æœå®¹å™¨ - ä½¿ç”¨ç½‘æ ¼å¸ƒå±€ */
        .rss-results-container {
            width: 100% !important;
            clear: both !important;
            margin-top: 10px !important;
            float: none !important;
            display: grid !important;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)) !important;
            gap: 15px !important;
        }

        /* ç¡®ä¿RSSç»“æœå®¹å™¨ä½¿ç”¨æ­£ç¡®çš„ç½‘æ ¼å¸ƒå±€ */
        #searchResults .box-card .rss-results-container {
            display: grid !important;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)) !important;
            gap: 15px !important;
        }

        /* å“åº”å¼å¸ƒå±€è°ƒæ•´ */
        @media screen and (max-width: 768px) {

            .rss-results-container,
            #searchResults .box-card .rss-results-container {
                grid-template-columns: 1fr !important;
            }
        }

        .rss-item {
            border: 1px solid #dbe3f0 !important;
            border-radius: 10px !important;
            background: linear-gradient(135deg, #e8f4ff 0%, #f0f0ff 100%) !important;
            margin-bottom: 0 !important;
            padding: 12px !important;
            overflow: hidden !important;
            width: 100% !important;
            box-sizing: border-box !important;
            display: block !important;
            box-shadow: 1px 2px 5px 0px #dceaf6 !important;
            transition: all 0.3s !important;
            height: 100% !important;
        }

        .rss-item:hover {
            box-shadow: 1px 2px 10px #9fc4d6 !important;
            border: 1px solid #62a6e2 !important;
        }

        .rss-item a {
            display: block !important;
            text-decoration: none !important;
            color: inherit !important;
            height: 100% !important;
            display: flex !important;
            flex-direction: column !important;
        }

        .rss-title {
            font-size: 14px !important;
            font-weight: 700 !important;
            color: #2c6ecb !important;
            margin-bottom: 8px !important;
            white-space: normal !important;
            line-height: 1.4 !important;
        }

        .rss-summary {
            font-size: 12px !important;
            color: rgb(89, 89, 89) !important;
            margin-bottom: 5px !important;
            line-height: 1.4 !important;
            overflow-wrap: break-word !important;
            display: -webkit-box !important;
            -webkit-box-orient: vertical !important;
            overflow: hidden !important;
            -webkit-line-clamp: 2 !important;
            flex-grow: 1 !important;
        }

        .rss-info {
            font-size: 12px !important;
            color: #999 !important;
            border-top: 1px dashed #e0e7f5 !important;
            padding-top: 8px !important;
            margin-top: 5px !important;
        }
    </style>
    <!-- end -->

    <!-- æ ¸å¿ƒæ–‡ä»¶ï¼Œè§£æexcelè¡¨æ ¼  å·²ä¸Šä¼ åˆ°å¸Œå°”æ¡Œé¢-->
    <!-- <script src="https://cdn.staticfile.org/xlsx/0.18.5/xlsx.core.min.js" type="application/javascript"></script> -->
    <script src="https://cdn.h5ds.com/space/files/600972551685382144/20240307/690223055768350720.js"
        type="application/javascript"></script><!-- <script src="js/xlsx.full.min.js"></script> -->
    <!-- é•œåƒåœ°å€ï¼š å®˜ç½‘æ‰¾åˆ°æ’ä»¶,distç›®å½•ä¸‹æœ‰å¾ˆå¤šä¸ªJSæ–‡ä»¶ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ç”¨xlsx.core.min.jså°±å¤Ÿäº†ï¼Œxlsx.full.min.jsåˆ™æ˜¯åŒ…å«äº†æ‰€æœ‰åŠŸèƒ½æ¨¡å—ã€‚
                https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js 
                https://lf9-cdn-tos.bytecdntp.com/cdn/expire-1-M/xlsx/0.18.2/xlsx.core.min.js -->
    <!-- end -->

    <!-- jqueryæœ¬åœ°æ–‡ä»¶å’Œå¤–é“¾ -->
    <script src='https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/jquery/3.6.0/jquery.min.js'></script>
    <!-- æœ€æ–°å¼•å…¥çš„js 2023å¹´7æœˆ1æ—¥æ”¹ä¸ºå­—èŠ‚è·³åŠ¨cdn,ç¼“å­˜æ—¶é—´æ˜¯ä¸€ä¸ªæœˆ -->
    <!-- end -->

    <!-- æ–°æ‰‹å¼•å¯¼ -->
    <script src="https://gcore.jsdelivr.net/npm/driver.js@1.3.6/dist/driver.js.iife.js"></script>
    <link rel="stylesheet" href="https://gcore.jsdelivr.net/npm/driver.js@1.3.6/dist/driver.css" />
    <!-- end -->

    <!-- åœ¨é¡µé¢åŠ è½½æ—¶æ‰§è¡Œ é€‚é…ä¸€äº›å®‰å“æ‰‹æœºåº•éƒ¨å¸¦å·¥å…·æ¡æ—¶ï¼Œç½‘ç«™ä¾§è¾¹æ è¶…å‡ºæ˜¾ç¤º -->
    <script>
        // åœ¨é¡µé¢åŠ è½½æ—¶æ‰§è¡Œ é€‚é…ä¸€äº›å®‰å“æ‰‹æœºåº•éƒ¨å¸¦å·¥å…·æ¡æ—¶ï¼Œç½‘ç«™ä¾§è¾¹æ è¶…å‡ºæ˜¾ç¤º
        document.addEventListener('DOMContentLoaded', adjustMaxHeight);
        function adjustMaxHeight() {
            // è·å–ç”¨æˆ·ä»£ç†å­—ç¬¦ä¸²
            var userAgent = navigator.userAgent.toLowerCase();
            // åˆ¤æ–­æ˜¯å¦ä¸ºå®‰å“è®¾å¤‡
            var isAndroid = userAgent.indexOf("android") > -1;
            // åˆ¤æ–­æ˜¯å¦ä¸ºè‹¹æœè®¾å¤‡
            var isApple = /iphone|ipad|ipod|macintosh/i.test(navigator.userAgent) && !window.MSStream;
            // åº”ç”¨ä¸åŒæ ·å¼
            if (isAndroid) {
                document.documentElement.style.setProperty('--adjustment', '225px'); /* 155px + 225px */
            } else {
                document.documentElement.style.setProperty('--adjustment', '155px');
            }
        }
    </script>
    <!-- end -->

</head>

<body>
    <div class="container" id="container">

        <!-- å·¦è¾¹å¯¼èˆªæ  -->
        <aside class=left-bar id=leftBar>
            <div class=title>
                <a href="https://blog.z-l.top" target="_blank" rel=noopener title=å…³äºæœ¬ç«™>
                    <i class=jiaran></i></a>
                <!-- h1æ˜¯æ–¹ä¾¿æœç´¢å¼•æ“,è®¾ç½®éšè—` -->
                <h1 style="display:none;">å¤djå¯¼èˆªç«™</h1><a target=_blank rel=noopener
                    href="https://cn.bing.com/search?q=å¤djå¯¼èˆª">å¤DJå¯¼èˆªç«™</a>
            </div>
            <nav class=nav>
                <div class="item active"><i class="iconfont icon-shoucangbenzhan"></i>
                    <a href="#" id="addToFavorites">âœ¨ç‚¹æˆ‘æ”¶è—æœ¬ç«™ğŸ‘ˆ</a>
                    <i class=line></i>
                </div>
                <div class="scroll-container">
                    <ul class=nav-item id=navItem>
                        <!-- æ­¤å¤„ç”±jsåŠ¨æ€ç”Ÿæˆ -->
                    </ul>
                </div>
                <div class="item comment"><a target=_blank rel=noopener href='//blog.z-l.top/posts/56198.html'><i
                            class="iconfont icon-gengxinrizhi"></i>æ›´æ–°æ—¥å¿—</a>
                    <a class="number"></a>
                </div>
            </nav>
        </aside>
        <!-- end -->

        <!-- ä¸»ä½“éƒ¨åˆ† -->
        <section id="main" class=main>
            <div id="mainContent">
                <div id=menu-box>
                    <div id=menu><input type=checkbox id=menu-form><label for=menu-form class=menu-spin>
                            <div class="line diagonal line-1"></div>
                            <div class="line horizontal"></div>
                            <div class="line diagonal line-2"></div>
                        </label></div>
                </div>
                <div class=header>
                    <nav>
                        <a id="buttonId">ğŸ”¯ä½¿ç”¨å¼•å¯¼</a>
                        <a target=_blank rel=noopener href="//blog.z-l.top/posts/djly.html" id="last">ğŸ“–è¯„è®ºç•™è¨€</a>
                        <a target=_blank rel=noopener href="//blog.z-l.top/posts/aboutdj.html">ğŸ‘¦å…³äºæœ¬ç«™</a>
                    </nav>
                </div>

                <!-- æœç´¢ğŸ”æ¨¡å— -->
                <div id=content>
                    <div class=con>
                        <section class=sousuo>
                            <div class=search>
                                <div class=search-box><i id="search-icon"
                                        style="color:#3385ff;background:url(https://soupian.pro/favicon.ico) no-repeat center/cover"></i>
                                    <input autocomplete=off class=search-input id=txt
                                        placeholder="&nbsp;è¾“å…¥å…³é”®å­—è¿›è¡Œæœç´¢ï¼Œç«™å†…æœç´¢é»˜è®¤å¼€å¯">
                                    <input id=search-clear
                                        style="background:url(https://cdn.h5ds.com/space/files/600972551685382144/20230826/619717930667061248.svg) no-repeat center/cover;display:none">
                                    <button class=search-btn title="æœç´¢æŒ‰é’®"></button>
                                </div>
                                <!-- <div class="box search-hot-text" id=search-box style="display:none">
                                    quicker1
                                    <ul></ul>
                                </div> -->
                                <div class=search-engine style=" display:none ">
                                    <div class=search-engine-head>
                                        <strong class="search-engine-tit">é€‰æ‹©æœç´¢å¼•æ“ï¼š</strong>
                                        <div class=search-engine-tool>ä»»æ„æœç´¢å¼•æ“å‡å¯ç«™å†…æœç´¢</div>
                                    </div>
                                    <ul class=search-engine-list></ul>
                                </div>
                            </div>
                        </section>
                    </div>
                </div>
                <!-- end -->

                <!-- æœ¬åœ°æµ‹è¯•æ—¶çš„æœç´¢çš„js -->
                <script src=js/search.js></script>
                <!-- ä¸Šä¼ æ—¶çš„æœç´¢js -->
                <!-- <script
                    src='https://cdn.h5ds.com/space/files/600972551685382144/20240706/734071112778821632.js'></script> -->
                <!-- end -->

                <!-- âœ¨ç®€çŸ­å…¬å‘Š -->
                <div class="box" id="å…¬å‘Š">
                    <!-- quicker2 -->
                    <a name=gonggao></a>
                    <div class=sub-category>
                        <span id="dome" class="left">
                            ğŸ‘‹æœ¬ç«™ç”±<span class=scr> å°å¼  </span>åˆ¶ä½œï¼Œæ–¹ä¾¿è‡ªå·±å’Œæœ‹å‹è€Œå­˜åœ¨çš„ä¸€ä¸ªè®¾è®¡å¯¼èˆªç½‘ç«™ ğŸ‘‰<a class=scr
                                href="https://link3.cc/xiadj">åŠ è½½ä¸å‡ºæ¥ç‚¹æˆ‘</a>ğŸ‘ˆ
                        </span>
                        <span class="right" id="UpTime">æœ€åæ›´æ–°</span>
                    </div>
                </div>
                <!-- end -->

                <!-- æœç´¢ç»“æœ -->
                <div class="box" id="searchResults" style="display:none;">
                    <a href="#" name="æœç´¢ç»“æœ" title="æœç´¢ç»“æœ"></a>
                    <div class="sub-category">
                        <div><i class="undefined"></i>ğŸ”æœ¬ç«™æœç´¢ç»“æœ<span>&nbsp; å¯ç»§ç»­ä½¿ç”¨å½“å‰æœç´¢å¼•æ“æœç´¢ğŸ˜€</span></div>
                    </div>
                    <div class="box-card">
                    </div>
                </div>
                <!-- end -->

                <!-- æˆ‘çš„å¯¼èˆª -->
                <!-- æˆ‘çš„å¯¼èˆªcssæ ·å¼ -->
                <style>
                    .box#my-fav-box {
                        display: none;
                    }

                    .my-fav-box-header {
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                        margin-bottom: 10px;
                    }

                    .my-fav-box-title {
                        font-size: 20px;
                        font-weight: bold;
                        letter-spacing: 1px;
                        display: flex;
                        align-items: center;
                    }

                    .my-fav-box-title-icon {
                        margin-right: 10px;
                    }



                    .my-fav-box-actions {
                        display: flex;
                        gap: 10px;
                    }

                    .my-fav-box-btn {
                        background: #f0f4ff;
                        color: #3273dc;
                        border: 1px solid #d4d7dd;
                        border-radius: 8px;
                        padding: 4px 16px;
                        cursor: pointer;
                        font-size: 15px;
                    }
                </style>

                <div class="box" id="my-fav-box">
                    <div class="my-fav-box">
                        <div class="my-fav-box-header">
                            <div class="my-fav-box-title">
                                <span class="my-fav-box-title-icon">ğŸŒŸ æˆ‘çš„å¯¼èˆª</span>
                                <!-- <span class="my-fav-box-desc">ï¼ˆå¯è‡ªå®šä¹‰æ·»åŠ ã€åˆ†ç±»ï¼Œæ‰¹é‡ç®¡ç†ï¼Œåˆ†äº«ï¼Œä»…è‡ªå·±å¯è§ï¼‰</span> -->
                                <!-- ï¼ˆå¯è‡ªå®šä¹‰æ·»åŠ ã€åˆ†ç±»ï¼Œæ‰¹é‡ç®¡ç†ï¼Œåˆ†äº«ï¼Œä»…è‡ªå·±å¯è§ -->

                            </div>
                            <div class="my-fav-box-actions">
                                <button id="fav-custom-btn" class="my-fav-box-btn">
                                    <span>âš™ï¸ç¼–è¾‘</span>
                                </button>
                                <button id="fav-batch-add-btn" class="my-fav-box-btn">
                                    <span>â• æœ¬ç«™æ•°æ®</span>
                                </button>
                            </div>
                        </div>
                        <div id="fav-list">
                            <!-- æ”¶è—å¡ç‰‡ç”±JSåŠ¨æ€ç”Ÿæˆ -->
                        </div>
                    </div>
                </div>
                <!-- end -->

                <!-- è¿™é‡Œæ˜¯excelè¡¨æ ¼çš„æ•°æ®,ç”±jsåŠ¨æ€ç”Ÿæˆ -->
                <div class="excel" id="excel" style="font-family: auto;"></div>
                <!-- end -->
            </div>
            <!-- ğŸ€é¡µè„šæ¨¡å— -->
            <footer class="footer">
                <div class="copyright">
                    <div>
                        &copy;2020 - 2024 By
                        <a target="_blank" rel="noopener" title="å¤DJå¯¼èˆªç«™" href="https://blog.z-l.top">å°å¼ </a>
                        -
                        <a title="èŒICPå¤‡20210214å·" href="//icp.gov.moe/?keyword=20210214" target="_blank"
                            rel="noopener">èŒICPå¤‡20210214å·</a>
                        -
                        <a target="_blank" rel="noopener" title="51LAç½‘ç«™ç»Ÿè®¡"
                            href="https://v6.51.la/land/K2FRAEqwdJ3Zqlj6">51LAç»Ÿè®¡</a>
                        -
                        <span id="span"></span>
                        <script type="text/javascript">
                            function runtime() {
                                var X = new Date('6/1/2021 8:32:00');
                                var Y = new Date();
                                var T = Y.getTime() - X.getTime();
                                var M = 86400000; // 1000 * 60 * 60 * 24
                                var a = T / M;
                                var A = Math.floor(a);
                                var b = 24 * (a - A);
                                var B = Math.floor(b);
                                var c = 60 * (b - B);
                                var C = Math.floor(c);
                                var D = Math.floor(60 * (c - C));
                                document.getElementById('span').innerHTML = 'ç½‘ç«™å·²è‰°éš¾è¿è¡Œ: ' + A + 'å¤©' + B + 'å°æ—¶' + C + 'åˆ†' + D + 'ç§’';
                            }
                            setInterval(runtime, 1000);
                        </script>
                    </div>
                </div>
            </footer>
            <!-- ğŸ€ -->
        </section>
    </div>

    <!-- è¿”å›é¡¶éƒ¨å’ŒèƒŒæ™¯ä»¥åŠè‡ªé€‚åº”pcå’ŒğŸ“± -->
    <script src="pages/backtotop-bg.js"></script>
    <!-- end -->

    <!-- 51laç½‘ç«™ç»Ÿè®¡ 51laæ€§èƒ½ç›‘æ§ç³»ç»Ÿ -->
    <script charset="UTF-8" id="LA_COLLECT" src="https://sdk.51.la/js-sdk-pro.min.js"></script>
    <script>LA.init({ id: "K2FRAEqwdJ3Zqlj6", ck: "K2FRAEqwdJ3Zqlj6" })</script>
    <script src="https://sdk.51.la/perf/js-sdk-perf.min.js" crossorigin="anonymous"></script>
    <script>
        new LingQue.Monitor().init({ id: "K2QGHIaETNJVc7Yp" });
    </script>
    <!-- end -->

    <!-- ChatGpt4ï¼šexcelè§£æåˆ°é¡µé¢ -->
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const url = "https://dh.z-l.top/zl.xlsx";
            fetch(url)
                .then((res) => res.blob())
                .then((blob) => {
                    const reader = new FileReader();
                    reader.onload = function (e) {
                        const data = e.target.result;
                        const workbook = XLSX.read(data, { type: "binary" });
                        const navItem = document.getElementById('navItem');
                        const mainContent = document.getElementById('excel');

                        // ä»workbookä¸­è·å–sheet1ä¸­C1ã€D1çš„å€¼ åˆ†åˆ«æ˜¯æ›´æ–°æ—¥æœŸå’Œå…¬å‘Š
                        const sheet1 = workbook.Sheets[workbook.SheetNames[0]];
                        const cellValueC1 = sheet1["C1"].v;
                        const cellValueD1 = sheet1["D1"].v;
                        // å°†å€¼æ’å…¥åˆ°é¡µé¢ä¸­idä¸ºUpTimeçš„spanå…ƒç´ ä¸­
                        document.getElementById('UpTime').innerHTML = cellValueC1;
                        document.getElementById('dome').innerHTML = cellValueD1;

                        workbook.SheetNames.forEach((sheetName, index) => {
                            const sheet = workbook.Sheets[sheetName];
                            const json = XLSX.utils.sheet_to_json(sheet, { header: 1 });


                            // å·¦ä¾§å¯¼èˆªåˆ—è¡¨å¤§åˆ†ç±»
                            const navLinkLi = document.createElement('li');
                            const navLink = document.createElement('a');
                            navLink.href = `#${sheetName}`;
                            const bigClass = sheet["F1"].v; // ä¿æŒä¸å˜
                            navLink.innerHTML = `<i class="iconfont ${bigClass}"></i>${sheetName}`; // ä¿æŒä¸å˜
                            // å¦‚æœæ˜¯ç¬¬ä¸€ä¸ªå¤§åˆ†ç±»ï¼Œåˆ™æ·»åŠ  active ç±»
                            if (index === 0) {
                                navLink.classList.add('active');
                            }
                            navLinkLi.appendChild(navLink);
                            // è¿™é‡Œå¼€å§‹è®¡ç®—å°åˆ†ç±»çš„æ•°é‡
                            let subCategoryCount = json[0].reduce((count, cell, cellIndex) => {
                                return cellIndex % 6 === 0 && cell ? count + 1 : count;
                            }, 0);
                            // å¦‚æœæœ‰å¤šäºä¸€ä¸ªå°åˆ†ç±»ï¼Œæ‰åˆ›å»ºäºŒçº§ç›®å½•
                            if (subCategoryCount > 1) {
                                const subNavList = document.createElement('ul');
                                subNavList.style.display = index === 0 ? "block" : "none";
                                navLinkLi.appendChild(subNavList);
                                // ä¿®æ”¹ç‚¹ï¼šåœ¨ç¡®è®¤éœ€è¦äºŒçº§ç›®å½•åï¼Œå†éå†åˆ›å»ºå°åˆ†ç±»å¯¼èˆª
                                json[0].forEach((cell, cellIndex) => {
                                    if (cellIndex % 6 === 0 && cell) {
                                        const subCategoryName = cell;
                                        // const subCategoryClass = json[0][cellIndex + 1];
                                        const subNavLinkLi = document.createElement('li');
                                        const subNavLink = document.createElement('a');
                                        // const chineseCharacters = subCategoryName.match(/[\u4e00-\u9fa5]{1,4}/);
                                        // const truncatedName = chineseCharacters ? chineseCharacters[0] : subCategoryName;
                                        // åŒ¹é…ä¸­æ–‡å­—ç¬¦å’Œå¸¸è§æ ‡ç‚¹ç¬¦å·ï¼Œä½†æ’é™¤äº†ä¸€äº›ç‰¹æ®Šå­—ç¬¦å’Œè¡¨æƒ…ç¬¦å·
                                        // åŒ¹é…ä¸­æ–‡å­—ç¬¦ã€è‹±æ–‡å­—ç¬¦å’Œå¸¸è§æ ‡ç‚¹ç¬¦å·ï¼Œä½†æ’é™¤äº†ä¸€äº›ç‰¹æ®Šå­—ç¬¦å’Œè¡¨æƒ…ç¬¦å·
                                        const chineseAndEnglish = subCategoryName.match(/[\u4e00-\u9fa5a-zA-Z,.\-()\/\[\]\{\}]+/g);
                                        const truncatedName = chineseAndEnglish ? chineseAndEnglish.join('').trim() : subCategoryName;
                                        subNavLink.innerHTML = truncatedName;
                                        // subNavLink.className = subCategoryClass;
                                        subNavLink.href = `#${sheetName}-${truncatedName}`;
                                        subNavLinkLi.appendChild(subNavLink);
                                        subNavList.appendChild(subNavLinkLi);
                                    }
                                });
                            }
                            navItem.appendChild(navLinkLi);


                            const categoryDiv = document.createElement('div');
                            categoryDiv.id = sheetName;
                            categoryDiv.className = 'box';
                            mainContent.appendChild(categoryDiv);

                            // è·å–å½“å‰å¤§åˆ†ç±»ä¸‹çš„å°åˆ†ç±»æ•°é‡
                            const numSubCategories = json[0].filter((_, index) => index % 6 === 0 && json[0][index]).length;

                            // å¦‚æœå°åˆ†ç±»æ•°é‡å¤§äº 1ï¼Œåˆ™æ˜¾ç¤ºå¤§åˆ†ç±»åç§°
                            if (numSubCategories > 1) {
                                categoryDiv.innerHTML = `<div class="sub-category">${sheetName}</div>`;
                            }

                            // åˆ›å»ºå’Œå¡«å……å†…å®¹çš„é€»è¾‘è°ƒæ•´ä»¥åŒ¹é…æ‰€éœ€ç»“æ„
                            // æ³¨æ„ï¼šè¿™é‡Œå‡è®¾jsonæ•°ç»„çš„ç¬¬ä¸€è¡ŒåŒ…å«åˆ—æ ‡é¢˜ï¼Œå®é™…æ•°æ®ä»ç¬¬äºŒè¡Œå¼€å§‹
                            for (let n = 0; n < json[0].length; n += 6) {
                                const subCategoryName = json[0][n]; // ç½‘ç«™å°åˆ†ç±»å
                                const subCategoryNamedesc = json[0][n + 1]; // ç½‘ç«™å°åˆ†ç±»çš„ä»‹ç»
                                const subCategoryId = json[0][n].match(/[\u4e00-\u9fa5a-zA-Z,.\-()\/\[\]\{\}]+/g); // è·å–å°åˆ†ç±»çš„é™¤å»å­—ä½“å›¾æ ‡çš„å‰©ä½™æ–‡å­—ä½œä¸ºid

                                if (!subCategoryName) continue;

                                let subCategoryDiv = document.getElementById(`${sheetName}-${subCategoryId}`); // å°åˆ†ç±»çš„å‰å››ä¸ªä¸­æ–‡æ±‰å­—ä½œä¸ºid
                                if (!subCategoryDiv) {
                                    subCategoryDiv = document.createElement('div');
                                    subCategoryDiv.id = `${sheetName}-${subCategoryId}`; // å°åˆ†ç±»çš„å‰å››ä¸ªä¸­æ–‡æ±‰å­—ä½œä¸ºid ä»¥ä¾¿å·¦ä¾§å¯¼èˆªç‚¹å‡»
                                    categoryDiv.appendChild(subCategoryDiv);
                                }

                                const subCategoryTitle = document.createElement('h2');

                                // æ£€æŸ¥ subCategoryNamedesc æ˜¯å¦ä¸ºç©º
                                const subCategoryTitleContent = subCategoryNamedesc ? `${subCategoryName} <span> ${subCategoryNamedesc}</span>` : subCategoryName;

                                // è®¾ç½® subCategoryTitle çš„ innerHTML
                                subCategoryTitle.innerHTML = subCategoryTitleContent;

                                subCategoryDiv.appendChild(subCategoryTitle);

                                const card = document.createElement("div");
                                card.className = "box-card";
                                subCategoryDiv.appendChild(card);

                                for (let i = 1; i < json.length; i++) {
                                    const rowData = json[i];
                                    if (!rowData[n]) continue;

                                    const name = rowData[n];
                                    const url = rowData[n + 1];
                                    const icon = rowData[n + 2];
                                    const desc = rowData[n + 3];
                                    const badge = rowData[n + 4];

                                    const itemWrapper = document.createElement("div");
                                    const itemLink = document.createElement("a");
                                    itemLink.setAttribute("rel", "noopener external nofollow noreferrer");
                                    itemLink.target = "_blank";
                                    itemLink.href = url;

                                    const item = document.createElement("div");
                                    // item.className = `item tags ${badge ? badge : ''}`.trim();
                                    item.className = 'item';
                                    // ç°åœ¨å°†è§’æ ‡é€»è¾‘æ”¾åœ¨è¿™é‡Œï¼Œç¡®ä¿å®ƒç´§æ¥åœ¨itemåˆ›å»ºä¹‹å
                                    if (badge) {
                                        const badgeClasses = badge.split(/\s+/).join(' ').trim();
                                        const badgeClassList = badgeClasses.split(' ');
                                        item.classList.add("tags", ...badgeClassList);

                                        const lastBadgeClass = badgeClassList[badgeClassList.length - 1].toLowerCase();
                                        const styleContent = `.${lastBadgeClass}::after { content: "${badgeClassList[badgeClassList.length - 1]}"; }`;

                                        let styleExists = false;
                                        let existingStyleTag = document.getElementById("è§’æ ‡æ ·å¼");
                                        if (!existingStyleTag) {
                                            existingStyleTag = document.createElement("style");
                                            existingStyleTag.id = "è§’æ ‡æ ·å¼";
                                            document.head.appendChild(existingStyleTag);
                                        } else if (existingStyleTag.textContent.includes(styleContent)) {
                                            styleExists = true;
                                        }

                                        if (!styleExists) {
                                            existingStyleTag.textContent += styleContent;
                                        }

                                        item.classList.add(lastBadgeClass);
                                    }
                                    const logoDiv = document.createElement('div');
                                    logoDiv.className = "logo";
                                    const logoImg = document.createElement('img');
                                    logoImg.loading = "lazy";
                                    logoImg.src = icon || `https://ico.cxr.cool/${new URL(url).hostname}.ico`;
                                    // æ·»åŠ å›¾æ ‡åŠ è½½å¤±è´¥æ—¶çš„å›é€€æ–¹æ¡ˆ
                                    logoImg.onerror = function () {
                                        const originalSrc = this.src;
                                        this.src = "https://cdn.jsdmirror.com/gh/xiaolongmr/test@main/1.png?failed=" + originalSrc;
                                        // é˜²æ­¢å¾ªç¯è§¦å‘onerror
                                        this.onerror = null;
                                    };
                                    // logoImg.src = icon || `https://api.hn/ico.php?url=https://${new URL(url).hostname}`;
                                    // logoImg.src = icon || `https://api.iowen.cn/favicon/${new URL(url).hostname}.png`;
                                    //å¤‡ç”¨ï¼šhttps://api.hn/ico.php?url=https://dh.z-l.top https://ui-avatars.com/api/?name=
                                    const logoSpan = document.createElement('span');
                                    logoSpan.innerHTML = name;
                                    logoDiv.appendChild(logoImg);
                                    logoDiv.appendChild(logoSpan);

                                    const siteDesc = document.createElement('div');
                                    siteDesc.className = "desc";
                                    siteDesc.innerHTML = desc || 'æè¿°åŠ è½½ä¸­...';
                                    if (!desc) {  // å¦‚æœæ²¡æœ‰æä¾›æè¿°ï¼Œå°è¯•ä½¿ç”¨APIè·å–
                                        // let siteUrl = new URL(url).hostname;
                                        let siteUrl = url.replace(/^http(s)?:\/\//i, "").split('/')[0];
                                        let descApiUrl = `https://v.api.aa1.cn/api/api-web-head/index.php?url=${siteUrl}&type=2`;
                                        fetch(descApiUrl)
                                            .then(response => response.text())
                                            .then(data => {
                                                siteDesc.innerHTML = data || 'æ— æè¿°ä¿¡æ¯';
                                            })
                                            .catch(error => {
                                                console.error('è·å–æè¿°å¤±è´¥:', error);
                                                siteDesc.innerHTML = 'æ— æè¿°ä¿¡æ¯';
                                            });
                                    }

                                    // ç»„è£…itemç»“æ„
                                    item.appendChild(logoDiv);
                                    item.appendChild(siteDesc);
                                    itemLink.appendChild(item);
                                    itemWrapper.appendChild(itemLink);
                                    card.appendChild(itemWrapper);

                                }
                            }
                        });


                    };
                    reader.readAsBinaryString(blob);
                })
                .catch((error) => {
                    console.error('Error:', error);
                });
        });


        // äºŒçº§èœå•æ˜¾ç¤ºéšè—å’Œç‚¹å‡»å¹³æ»‘æ»šåŠ¨æ•ˆæœ
        $(document).ready(function () {
            // å·¦ä¾§èœå•æ ç‚¹å‡»äº‹ä»¶å¤„ç†
            document.body.addEventListener('click', function (e) {
                if (e.target.matches('#navItem > li > a')) {
                    e.preventDefault();
                    // ç§»é™¤æ‰€æœ‰åˆ†ç±»çš„æ¿€æ´»çŠ¶æ€
                    document.querySelectorAll('#navItem a').forEach(nav => nav.classList.remove('active'));
                    // éšè—æ‰€æœ‰å°åˆ†ç±»åˆ—è¡¨
                    document.querySelectorAll('#navItem > li > ul').forEach(subNav => subNav.style.display = 'none');

                    // ä¸ºå½“å‰ç‚¹å‡»çš„å¤§åˆ†ç±»æ·»åŠ æ¿€æ´»çŠ¶æ€ï¼Œå¹¶æ˜¾ç¤ºå®ƒçš„å°åˆ†ç±»åˆ—è¡¨
                    e.target.classList.add('active');
                    const nextElement = e.target.nextElementSibling;
                    if (nextElement && nextElement.tagName === 'UL') {
                        nextElement.style.display = 'block';
                    }

                    // è·å–ç›®æ ‡å…ƒç´ 
                    const targetId = e.target.getAttribute('href').split('#')[1];
                    const targetElement = document.getElementById(targetId);
                    if (targetElement) {
                        // ä½¿ç”¨ jQuery animate() æ–¹æ³•æ·»åŠ å¹³æ»‘çš„é¡µé¢æ»šåŠ¨
                        $('html, body').animate({
                            scrollTop: $(targetElement).offset().top
                        }, 500);
                        // ä¿®æ”¹URLæ å†…å®¹
                        history.pushState(null, null, `#${targetId}`);
                    }
                }

                if (e.target.tagName === 'A' && e.target.parentElement.parentElement.tagName === 'UL') {
                    e.preventDefault();
                    // ç§»é™¤æ‰€æœ‰åˆ†ç±»çš„æ¿€æ´»çŠ¶æ€
                    document.querySelectorAll('#navItem a').forEach(nav => nav.classList.remove('active'));

                    // ä¸ºå½“å‰ç‚¹å‡»çš„å°åˆ†ç±»æ·»åŠ æ¿€æ´»çŠ¶æ€
                    e.target.classList.add('active');

                    // è·å–ç›®æ ‡å…ƒç´ 
                    const targetId = e.target.getAttribute('href').split('#')[1];
                    const targetElement = document.getElementById(targetId);
                    if (targetElement) {
                        // ä½¿ç”¨ jQuery animate() æ–¹æ³•æ·»åŠ å¹³æ»‘çš„é¡µé¢æ»šåŠ¨
                        $('html, body').animate({
                            scrollTop: $(targetElement).offset().top
                        }, 500);
                        // ä¿®æ”¹URLæ å†…å®¹
                        history.pushState(null, null, `#${targetId}`);
                    }
                }
            });
        });


    </script>
    <!-- end -->

    <!-- ç”¨æˆ·å¼•å¯¼jsä»£ç éƒ¨åˆ† -->
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const driver = window.driver.js.driver;
            const driverObj = driver({
                showProgress: true,
                overlayColor: 'black',
                overlayOpacity: 0.75,
                stagePadding: 8,
                showButtons: ['ä¸‹ä¸€æ­¥', 'ä¸Šä¸€æ­¥'],
                nextBtnText: 'ä¸‹ä¸€æ­¥', // Next button text for this step ä¸‹ä¸€æ­¥æŒ‰é’®çš„æ–‡å­—
                prevBtnText: 'ä¸Šä¸€æ­¥', // Previous button text for this step ä¸Šä¸€æ­¥æŒ‰é’®æ–‡å­—
                showButtons: true, // Do not show control buttons in footer æ˜¯å¦åœ¨åº•éƒ¨æ˜¾ç¤ºæŒ‰é’®
                doneBtnText: 'å®Œæˆ', // Text on the final button å®ŒæˆæŒ‰é’®çš„æ–‡å­—
                popoverClass: "driverjs-theme",
                steps: [
                    { element: '#å…¬å‘Š', popover: { title: 'å¼€å§‹ä¹‹å‰', description: 'è¿™æ˜¯ä¸€ä¸ªå…³äºæœ¬ç«™çš„ç®€å•ä»‹ç»ï¼Œæƒ³è¦äº†è§£æœ¬ç«™å¯ç‚¹å‡»ä¸Šæ–¹ ğŸ‘¦å…³äºæœ¬ç«™ï¼ˆç”µè„‘å¯ä½¿ç”¨æ–¹å‘é”®è¿›è¡Œæœ¬å¼•å¯¼ï¼‰', side: "bottom", align: 'center', nextBtnText: "å¼€å§‹ï¼", } },
                    { element: '.search-box', popover: { title: 'æœç´¢æ¨¡å—', description: 'å†…ç½®å¤šæ¬¾å¼•æ“æœç´¢ï¼ŒåŒæ—¶æä¾› <span style="color:hotpink"> ç«™å†…æœç´¢</span>', side: "bottom", align: 'center' } },
                    { element: '.sousuo .search-box #search-icon', popover: { title: 'è¶…å¤šæœç´¢å¼•æ“', description: 'ç‚¹å‡»æ­¤å¤„åˆ‡æ¢æœç´¢å¼•æ“ï¼Œæ€»æœ‰ä¸€æ¬¾é€‚åˆä½ ~', side: "bottom", align: 'start' } },
                    { element: '.nav-item', popover: { title: 'ç½‘ç«™åˆ†ç±»', description: 'ç‚¹å‡»å·¦ä¾§è¿™é‡Œçš„åˆ†ç±»å³è¾¹å°±ä¼šè·³è½¬è‡³ç›¸åº”ä½ç½® (æ‰‹æœºç«¯ç‚¹å‡»å³ä¸‹è§’  <b>â‰¡</b> )', side: "left", align: 'center' } },
                    { element: '.excel #ç½®é¡¶ç½‘ç«™-ç½®é¡¶æ¨è', popover: { title: 'ä¸»è¦ç»„æˆ', description: 'æ¯ä¸€ä¸ªå¤§å¡ç‰‡æ˜¯ä¸€ä¸ªå¤§åˆ†ç±»ï¼ŒåŒ…å«è‹¥å¹²å°åˆ†ç±»ï¼Œæ¯ä¸ªå°å¡ç‰‡æ˜¯ä¸€ä¸ªç½‘ç«™ï¼Œç½‘ç«™é…æœ‰å›¾æ ‡å’Œç½‘ç«™çš„ä»‹ç»ï¼', side: "top", align: 'center' } },
                    { element: '.excel .box:nth-child(1) .box-card div:nth-child(1)', popover: { title: 'è§’æ ‡', description: 'è§’æ ‡ç§ç±»ï¼šğŸ”¥ï¼Œæ”¶è—ï¼Œæ¨èï¼ŒUIï¼Œå¤§ä½¬ã€‚ç›®å‰ä»…ç”±ç«™é•¿è¯„ä¼°æ·»åŠ ï¼Œæ¬¢è¿<span style="color:hotpink"> ç•™è¨€æ¢è®¨</span>', side: "right", align: 'start' } },
                    { element: '.ctrm-title', popover: { title: 'åŒ¿åèŠå¤©å®¤', description: 'åœ¨è¿™é‡Œå¯ä»¥å’Œå…¶ä»–æµè§ˆè€…ç•…æ‰€æ¬²è¨€ï¼Œä½†è¦æ³¨æ„æ–‡æ˜äº¤æµå“¦ï¼', side: "top", align: 'center' } },
                    { element: '#last', popover: { title: 'ç»“æŸï¼', description: 'æœ€åï¼Œå·å·å‘Šè¯‰ä½ ï¼Œç½‘ç«™æ•°æ®å…¨éƒ¨å‚¨å­˜åœ¨excelè¡¨æ ¼é‡Œï¼åŒæ—¶æ¬¢è¿æ‚¨çš„æ¨è<img alt=":å¤§å“­:" src="https://cdn.h5ds.com/space/files/600972551685382144/20230820/617614164123377664.png" style="width: 2rem;margin-left: 0.5rem;">', side: "bottom", align: 'center' } },
                ]
            });
            // driverObj.drive();
            document.getElementById('buttonId').addEventListener('click', function () {
                // å¯åŠ¨å¼•å¯¼
                driverObj.drive();
            });
        });
    </script>
    <!-- end -->

    <!-- ç½‘ç«™æ”¶å½•æ•°é‡ æ”¶è—æœ¬ç«™ å›½å®¶çºªå¿µæ—¥è‡ªåŠ¨å˜ç°   -->
    <script>
        // ç½‘ç«™æ”¶å½•æ•°é‡
        window.onload = function () {
            // è·å–classä¸ºlogoçš„å…ƒç´ æ•°é‡
            var logoNum = document.getElementsByClassName('logo').length;
            // å°†æ•°é‡æ‰“å°åˆ°é¡µé¢ä¸Š
            document.getElementsByClassName('number')[0].innerHTML = '   ç½‘ç«™æ•°:' + logoNum;
        }

        // æ”¶è—æœ¬ç«™
        document.getElementById("addToFavorites").addEventListener("click", function (event) {
            event.preventDefault();
            alert("è¯·ä½¿ç”¨ Ctrl+Dï¼ˆæˆ– Command+D åœ¨ Mac ä¸Šï¼‰æ¥æ”¶è—æœ¬ç«™");
        });

        //å›½å®¶çºªå¿µæ—¥è‡ªåŠ¨å˜ç° - æ™ºèƒ½è¯†åˆ«èŠ‚æ—¥åŠŸèƒ½
        function handleMemorialDays() {
            // è·å–å½“å‰æ—¥æœŸ
            var currentDate = new Date();
            var mon = currentDate.getMonth() + 1;
            var date = currentDate.getDate();
            var dateKey = mon + '.' + date;

            // é€šç”¨æ ·å¼å’Œæç¤ºæ–‡æœ¬
            var siteNotice = '<br><span style="color:#999;font-size:0.9em;">å…¨ç«™å·²åˆ‡æ¢ä¸ºé»‘ç™½æ¨¡å¼, å…³é—­åŒ¿åèŠå¤©!</span>';

            // å¤–é“¾èµ„æºURL 
            var sweetalertUrl = "https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/limonte-sweetalert2/8.19.0/sweetalert2.all.min.js";
            var animateCssUrl = "https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/animate.css/4.1.1/animate.min.css";
            var fontAwesomeUrl = "https://cdn.bootcdn.net/ajax/libs/font-awesome/6.5.1/css/all.min.css";
            var specialScriptUrl = "js/chatzl-uploader-fixed.js"; //èŠå¤©è„šæœ¬
            // var specialScriptUrl = "js/chatzl.js"; //æœ¬åœ°æµ‹è¯•å°¬èŠ
            // var specialScriptUrl = "https://z-l.top/chat.js"; //ä¸Šä¼ æ—¶å€™çš„å°¬èŠï¼Œéœ€è¦æ”¹åå­—å’Œä½ç½®
            // var specialScriptUrl = "js/chat-åŸç‰ˆ.js"; //å°¬èŠ

            // å»ºç«‹çºªå¿µæ—¥æ˜ å°„è¡¨ï¼Œå…³è”æ—¥æœŸå’Œçºªå¿µæ—¥åç§°åŠç›¸å…³ä¿¡æ¯
            var memorialDays = {
                '4.4': {
                    name: 'æ¸…æ˜èŠ‚',
                    description: 'ç¼…æ€€é€è€…ã€å¯„æ‰˜å“€æ€çš„ä¼ ç»ŸèŠ‚æ—¥ã€‚',
                    icon: 'fa-solid fa-leaf',
                    image: 'https://img.z-l.top/file/dh/Biauf37s.jpeg',
                    link: 'https://baike.baidu.com/item/æ¸…æ˜èŠ‚',
                    buttonText: 'ç¼…æ€€å…ˆäºº',
                    buttonIcon: 'fa-solid fa-flower'
                },
                '6.12': {
                    name: 'æ±¶å·åœ°éœ‡çºªå¿µæ—¥',
                    description: 'çºªå¿µ2008å¹´æ±¶å·8.0çº§åœ°éœ‡é‡éš¾åŒèƒã€‚',
                    icon: 'fa-solid fa-house-crack',
                    image: 'https://img.z-l.top/file/dh/HthPHf7z.jpeg',
                    link: 'https://baike.baidu.com/item/æ±¶å·å¤§åœ°éœ‡',
                    buttonText: 'ç¥ˆç¦å¹³å®‰',
                    buttonIcon: 'fa-solid fa-candle-holder'
                },
                '7.7': {
                    name: 'ä¸ƒä¸ƒäº‹å˜çºªå¿µæ—¥',
                    description: '1937å¹´å…¨é¢æŠ—æˆ˜çˆ†å‘ï¼Œå‹¿å¿˜å›½è€»ã€‚',
                    icon: 'fa-solid fa-flag',
                    image: 'https://www.huaxia.com/upload/resources/image/2022/07/07/326449_375x230c.jpg',
                    link: 'https://baike.baidu.com/item/ä¸ƒä¸ƒäº‹å˜',
                    buttonText: 'å‹¿å¿˜å›½è€»',
                    buttonIcon: 'fa-solid fa-flag'
                },
                '9.9': {
                    name: 'æ¯›æ³½ä¸œä¸»å¸­é€ä¸–çºªå¿µæ—¥',
                    description: 'ç¼…æ€€ä¼Ÿäººæ°¸å‚ä¸æœ½ã€‚',
                    icon: 'fa-solid fa-star',
                    image: 'https://img.z-l.top/file/dh/ZYntsBWA.jpeg',
                    link: 'https://baike.baidu.com/item/æ¯›æ³½ä¸œ',
                    buttonText: 'ç¼…æ€€ä¼Ÿäºº',
                    buttonIcon: 'fa-solid fa-star'
                },
                '9.18': {
                    name: 'ä¹ä¸€å…«äº‹å˜çºªå¿µæ—¥',
                    description: '1931å¹´æ—¥æœ¬ä¾µç•¥ä¸­å›½ä¸œåŒ—ï¼Œå‹¿å¿˜å›½è€»ã€‚',
                    icon: 'fa-solid fa-bell',
                    image: 'https://img.z-l.top/file/dh/kXi768dJ.jpeg',
                    link: 'https://baike.baidu.com/item/ä¹ä¸€å…«äº‹å˜',
                    buttonText: 'å‹¿å¿˜å›½è€»',
                    buttonIcon: 'fa-solid fa-flag'
                },
                '12.13': {
                    name: 'å—äº¬å¤§å± æ€æ­»éš¾è€…å›½å®¶å…¬ç¥­æ—¥',
                    description: 'é“­è®°å†å²ï¼Œç¼…æ€€é‡éš¾åŒèƒï¼Œççˆ±å’Œå¹³ã€‚',
                    icon: 'fa-solid fa-dove',
                    image: 'https://img.z-l.top/file/dh/95a3cXdB.png',
                    link: 'https://baike.baidu.com/item/å—äº¬å¤§å± æ€',
                    buttonText: 'å’Œå¹³æ°¸å­˜',
                    buttonIcon: 'fa-solid fa-dove'
                }
            };

            // æ£€æŸ¥å½“å‰æ—¥æœŸæ˜¯å¦æ˜¯çºªå¿µæ—¥
            function isMemorialDay() {
                return memorialDays.hasOwnProperty(dateKey);
            }

            // å¤„ç†çºªå¿µæ—¥æ˜¾ç¤º
            function showMemorialDayAlert() {
                var memorial = memorialDays[dateKey];

                // åº”ç”¨ç°è‰²æ»¤é•œ
                var styleElement = document.createElement('style');
                styleElement.textContent = 'html {filter: gray!important; -webkit-filter: grayscale(95%)!important; filter: grayscale(95%)!important;} @media screen and(max-width:768px) {.layout{filter: gray!important; -webkit-filter: grayscale(95%)!important; filter: grayscale(95%)!important;}}';
                document.head.appendChild(styleElement);

                // åŠ è½½å¤–éƒ¨èµ„æº
                loadExternalResource('link', fontAwesomeUrl, function () {
                    loadExternalResource('link', animateCssUrl, function () {
                        loadExternalResource('script', sweetalertUrl, function () {
                            // å…¨éƒ¨èµ„æºåŠ è½½å®Œæ¯•ï¼Œæ˜¾ç¤ºå¼¹çª—
                            Swal.fire({
                                title: `<strong><i class="${memorial.icon}"></i> ä»Šå¤©æ˜¯  <a href="${memorial.link}" target="_blank" >${memorial.name}</a></strong>`,
                                html: `${memorial.description}${siteNotice}`,
                                imageUrl: memorial.image,
                                imageWidth: 400,
                                imageHeight: 200,
                                imageAlt: memorial.name,
                                focusConfirm: false,
                                confirmButtonText: `<i class="${memorial.buttonIcon}"></i> ${memorial.buttonText}`,
                                animation: true,
                                customClass: {
                                    popup: 'kapian animated rubberBand'
                                },
                                padding: '1.5em 1em',
                                background: '#ffffffcf bottom right repeat',
                                backdrop: `rgba(0,0,123,0.4)`,
                                timer: 999999,
                            });
                        });
                    });
                });
            }

            // è¾…åŠ©å‡½æ•°ï¼šæŒ‰é¡ºåºåŠ è½½å¤–éƒ¨èµ„æº
            function loadExternalResource(type, url, callback) {
                let element;
                if (type === 'script') {
                    element = document.createElement('script');
                    element.src = url;
                    element.async = true;
                } else if (type === 'link') {
                    element = document.createElement('link');
                    element.rel = 'stylesheet';
                    element.href = url;
                }

                if (callback) {
                    element.onload = callback;
                }

                document.head.appendChild(element);
                return element;
            }

            // åŠ è½½èŠå¤©è„šæœ¬
            function loadChatScript() {
                var script = document.createElement('script');
                script.src = specialScriptUrl;
                script.async = true;
                script.setAttribute('fold', '');
                document.body.appendChild(script);
            }

            // ä¸»å¤„ç†é€»è¾‘
            if (isMemorialDay()) {
                document.addEventListener('DOMContentLoaded', showMemorialDayAlert);
            } else {
                loadChatScript();
            }
        }
        // è°ƒç”¨çºªå¿µæ—¥å¤„ç†å‡½æ•°
        handleMemorialDays();

    </script>
    <!-- end -->

    <!-- æ·»åŠ ç«™å†…æœç´¢ - æ”¯æŒæ‹¼éŸ³æ¨¡ç³Šæœç´¢ -->
    <!-- å¼•å…¥æ±‰å­—è½¬æ‹¼éŸ³åº“ -->
    <script src="https://cdn.jsdelivr.net/npm/pinyin-pro/dist/index.js"></script>
    <script>
        /**
         * æœç´¢åŠŸèƒ½é…ç½®é€‰é¡¹
         * å¯æ ¹æ®éœ€è¦ä¿®æ”¹ä¸‹é¢çš„é…ç½®å‚æ•°
         */
        const searchConfig = {
            // æ˜¯å¦åœ¨æ§åˆ¶å°è¾“å‡ºè°ƒè¯•ä¿¡æ¯
            debug: false,

            // æœç´¢ç»“æœæœ€å¤§æ˜¾ç¤ºæ•°é‡
            maxResults: 50,

            // æ˜¯å¦æ˜¾ç¤ºåŒ¹é…ç±»å‹æ ‡ç­¾ (å¦‚[æ‹¼éŸ³åŒ¹é…], [ç²¾å‡†åŒ¹é…]ç­‰)
            showMatchType: true,

            // æ‹¼éŸ³åŒ¹é…ç›¸å…³é…ç½®
            pinyin: {
                // æ˜¯å¦å¯ç”¨æ‹¼éŸ³æœç´¢
                enabled: true,
                // æ˜¯å¦å¯ç”¨é¦–å­—æ¯æœç´¢
                enableFirstLetter: true,
                // æ˜¯å¦æ”¯æŒè¾“å…¥æ³•æ‹¼éŸ³çŠ¶æ€
                supportInputMethod: true
            },

            // RSSæºé…ç½®
            rss: {
                // æ˜¯å¦å¯ç”¨RSSæºæœç´¢
                enabled: true,
                // RSSæºåˆ—è¡¨
                sources: [
                    "https://rss.z-l.top/",
                    "https://www.axure.com.cn/feed",
                    "https://feeds.appinn.com/appinns/",
                    "https://blog.zhheo.com/rss.xml",
                    "https://www.bossdesign.cn/feed/",
                    "https://www.bossdesign.cn/design-software/feed/",
                    "https://www.bossdesign.cn/computer-skills/feed/",
                    "https://rss.app/feeds/v9FbHSRvCj75ZQW2.xml",
                    "https://www.ftium4.com/rss.xml",
                    "https://www.woshipm.com/feed",
                    "https://www.uy5.net/feed/",
                    "https://moonvy.com/blog/rss.xml",
                    "https://rss.app/feeds/tdY4NN4FTTkG8tDk.xml",
                    "https://rss.app/feeds/mh0pDllvY0Slfz0X.xml",
                    "https://uiiiuiii.com/feed",
                    "https://rss.app/feeds/5oAM8rklMrtj7Xqa.xml",
                    "https://rss.app/feeds/krVDP1roF2B3MaMa.xml",
                    "https://blenderco.cn/feed",
                    "https://www.lookae.com/qitarjcj/pszy/feed/",
                ],
                // RSSæ¡ç›®çš„æœ€å¤§æ•°é‡é™åˆ¶
                maxEntries: 50
            },

            // æœç´¢ç»“æœæ ·å¼é…ç½®
            style: {
                // åŒ¹é…ç±»å‹æ ‡ç­¾é¢œè‰²
                exactMatchColor: '#4caf50',    // ç²¾å‡†åŒ¹é…
                pinyinMatchColor: '#2196f3',   // æ‹¼éŸ³åŒ¹é…
                descMatchColor: '#9e9e9e',     // æè¿°åŒ¹é…
                rssMatchColor: '#ff9800'       // RSSåŒ¹é…
            }
        };

        // åˆå§‹åŒ–æœç´¢æ•°æ®
        var searchableItems = [];
        // å­˜å‚¨RSSæ•°æ®
        var rssItems = [];

        // DOMåŠ è½½å®Œæˆååˆå§‹åŒ–æœç´¢æ•°æ®
        document.addEventListener('DOMContentLoaded', function () {
            // ç­‰å¾…Excelæ•°æ®åŠ è½½å®Œæˆåæ‰§è¡Œ
            setTimeout(function () {
                initSearchData();
                // å¦‚æœå¯ç”¨äº†RSSæœç´¢ï¼ŒåŠ è½½RSSæ•°æ®
                if (searchConfig.rss && searchConfig.rss.enabled) {
                    loadRssData();
                }
            }, 1000);
        });

        // åˆå§‹åŒ–æœç´¢æ•°æ®å‡½æ•°
        function initSearchData() {
            var items = document.querySelectorAll('.box-card .item');
            if (searchConfig.debug) {
                console.log('å¼€å§‹åˆå§‹åŒ–æœç´¢æ•°æ®ï¼Œæ‰¾åˆ°é¡¹ç›®æ•°: ' + items.length);
            }

            // æ£€æŸ¥æ‹¼éŸ³åº“æ˜¯å¦åŠ è½½
            if (!window.pinyinPro) {
                if (searchConfig.debug) {
                    console.error('æ‹¼éŸ³åº“æœªåŠ è½½ï¼Œå°è¯•é‡æ–°åŠ è½½');
                }
                // å¦‚æœæ‹¼éŸ³åº“æœªåŠ è½½ï¼Œå°è¯•é‡æ–°åŠ è½½
                var script = document.createElement('script');
                script.src = 'https://cdn.jsdelivr.net/npm/pinyin-pro/dist/index.js';
                script.onload = function () {
                    if (searchConfig.debug) {
                        console.log('æ‹¼éŸ³åº“åŠ è½½æˆåŠŸï¼Œé‡æ–°åˆå§‹åŒ–');
                    }
                    initSearchData();
                };
                document.head.appendChild(script);
                return;
            }

            items.forEach(function (item, index) {
                var descElement = item.querySelector('.desc');
                var logoElement = item.querySelector('.logo');

                if (!descElement || !logoElement) return;

                // æå–æ–‡æœ¬
                var desc = extractTextContent(descElement);
                var title = logoElement.textContent.trim();

                // ç”Ÿæˆæ‹¼éŸ³ - å¢å¼ºç‰ˆ
                var titlePinyin = '';
                var titlePinyinFirst = '';
                var titlePinyinNone = ''; // ä¸å¸¦å£°è°ƒçš„æ‹¼éŸ³

                try {
                    // ä½¿ç”¨pinyin-proåº“
                    // å…¨æ‹¼ï¼ˆä¸å¸¦å£°è°ƒï¼‰
                    titlePinyin = pinyinPro.pinyin(title, { toneType: 'none' }).toLowerCase();

                    // é¦–å­—æ¯ - åŒæ—¶ä¿å­˜å¸¦ç©ºæ ¼å’Œä¸å¸¦ç©ºæ ¼çš„ç‰ˆæœ¬
                    titlePinyinFirst = pinyinPro.pinyin(title, { pattern: 'first', toneType: 'none' }).toLowerCase();

                    // ä¸å¸¦å£°è°ƒçš„æ‹¼éŸ³ï¼ˆä¸titlePinyinç›¸åŒï¼Œä½†ä¿ç•™å˜é‡åä»¥å…¼å®¹ç°æœ‰ä»£ç ï¼‰
                    titlePinyinNone = titlePinyin;

                    // æ ¹æ®é…ç½®å†³å®šæ˜¯å¦æ‰“å°è°ƒè¯•ä¿¡æ¯
                    if (searchConfig.debug && index % 5 === 0) {
                        console.log(`[${index}] æ ‡é¢˜: ${title}`);
                        console.log(`     - å…¨æ‹¼: ${titlePinyin}`);
                        console.log(`     - é¦–å­—æ¯: ${titlePinyinFirst}`);
                        console.log(`     - æ— å£°è°ƒ: ${titlePinyinNone}`);
                    }

                } catch (e) {
                    console.error(`æ‹¼éŸ³è½¬æ¢å‡ºé”™ [${title}]:`, e);
                }

                // å­˜å‚¨æœç´¢æ•°æ®
                searchableItems.push({
                    element: item.parentElement,
                    title: title.toLowerCase(),
                    desc: desc.toLowerCase(),
                    titlePinyin: titlePinyin,
                    titlePinyinNone: titlePinyinNone,
                    titlePinyinFirst: titlePinyinFirst
                });
            });

            if (searchConfig.debug) {
                console.log('æœç´¢æ•°æ®åˆå§‹åŒ–å®Œæˆï¼ŒåŒ…å« ' + searchableItems.length + ' é¡¹');
            }
        }

        // æå–å…ƒç´ ä¸­çš„æ‰€æœ‰æ–‡æœ¬å†…å®¹
        function extractTextContent(element) {
            let text = '';
            for (var i = 0; i < element.childNodes.length; i++) {
                var childNode = element.childNodes[i];
                if (childNode.nodeType === Node.TEXT_NODE) {
                    text += childNode.textContent;
                } else if (childNode.nodeType === Node.ELEMENT_NODE) {
                    text += childNode.textContent;
                }
            }
            return text.trim();
        }

        // ä¸“é—¨ç”¨äºæ‹¼éŸ³è¾“å…¥çŠ¶æ€çš„æœç´¢å‡½æ•°
        function performPinyinSearch(pinyinKeyword) {
            pinyinKeyword = pinyinKeyword.toLowerCase().trim();
            var results = [];

            if (searchConfig.debug) {
                console.log('æ‰§è¡Œæ‹¼éŸ³è¾“å…¥çŠ¶æ€æœç´¢: "' + pinyinKeyword + '"');
            }

            // å¦‚æœå…³é”®è¯ä¸ºç©ºæˆ–æ‹¼éŸ³æœç´¢è¢«ç¦ç”¨ï¼Œç›´æ¥è¿”å›ç©ºç»“æœ
            if (!pinyinKeyword || !searchConfig.pinyin.enabled) {
                return results;
            }

            // æå–çº¯æ‹¼éŸ³éƒ¨åˆ†ï¼ˆå»é™¤å¯èƒ½çš„æ ‡ç‚¹å’Œç‰¹æ®Šå­—ç¬¦ï¼‰
            const pureKeyword = pinyinKeyword.replace(/[^a-z0-9]/g, '');

            // æœç´¢æ‰€æœ‰é¡¹ç›®
            searchableItems.forEach(function (item) {
                // 1. æ£€æŸ¥æ‹¼éŸ³å…¨æ‹¼æ˜¯å¦åŒ…å«æœç´¢è¯
                if (item.titlePinyin && item.titlePinyin.includes(pureKeyword)) {
                    item.matchType = 'pinyin_input';
                    item.matchWeight = 75;
                    results.push({ ...item }); // åˆ›å»ºå‰¯æœ¬ä»¥é¿å…é‡å¤æ·»åŠ 
                    return;
                }

                // 2. æ£€æŸ¥æ‹¼éŸ³é¦–å­—æ¯æ˜¯å¦åŒ¹é…
                let compactFirstLetters = item.titlePinyinFirst.replace(/\s+/g, '');
                if (compactFirstLetters.includes(pureKeyword)) {
                    item.matchType = 'pinyin_input_first';
                    item.matchWeight = 70;
                    results.push({ ...item }); // åˆ›å»ºå‰¯æœ¬ä»¥é¿å…é‡å¤æ·»åŠ 
                    return;
                }

                // 3. å°è¯•åŒ¹é…æ‹¼éŸ³çš„å¼€å¤´éƒ¨åˆ†ï¼ˆä¾‹å¦‚ï¼šè¾“å…¥"zhangc"å¯ä»¥åŒ¹é…"å¼ æ˜¥"ï¼‰
                if (item.titlePinyin && item.titlePinyin.startsWith(pureKeyword)) {
                    item.matchType = 'pinyin_input_start';
                    item.matchWeight = 80; // ç»™äºˆæ›´é«˜æƒé‡
                    results.push({ ...item });
                    return;
                }

                // 4. å°è¯•åŒ¹é…å•ä¸ªæ±‰å­—çš„æ‹¼éŸ³ï¼ˆé’ˆå¯¹è¾“å…¥æ³•çŠ¶æ€ï¼‰
                const titleChars = item.title.split('');
                let matched = false;

                for (let i = 0; i < titleChars.length; i++) {
                    if (/[\u4e00-\u9fa5]/.test(titleChars[i])) { // æ˜¯å¦ä¸ºæ±‰å­—
                        try {
                            // è·å–å•ä¸ªæ±‰å­—çš„æ‹¼éŸ³
                            const charPinyin = pinyinPro.pinyin(titleChars[i], { toneType: 'none' }).toLowerCase();
                            // æ£€æŸ¥æ˜¯å¦åŒ¹é…è¾“å…¥çš„å¼€å¤´éƒ¨åˆ†
                            if (charPinyin.startsWith(pureKeyword) || pureKeyword.startsWith(charPinyin)) {
                                matched = true;
                                break;
                            }
                        } catch (e) {
                            if (searchConfig.debug) {
                                console.error('å•å­—æ‹¼éŸ³åŒ¹é…å‡ºé”™:', e);
                            }
                        }
                    }
                }

                if (matched) {
                    item.matchType = 'pinyin_input_char';
                    item.matchWeight = 65;
                    results.push({ ...item });
                    return;
                }
            });

            // æŒ‰åŒ¹é…æƒé‡æ’åº
            results.sort(function (a, b) {
                return b.matchWeight - a.matchWeight;
            });

            return results;
        }

        // å¸¸è§„æœç´¢å‡½æ•°
        function performSearch(keyword) {
            keyword = keyword.toLowerCase().trim();
            var results = [];

            if (searchConfig.debug) {
                console.log('æ‰§è¡Œå…³é”®è¯æœç´¢ï¼ˆéæ‹¼éŸ³æœç´¢æ¨¡å¼ï¼‰');
            }

            // å¤„ç†è¾“å…¥æ³•æ‹¼éŸ³çŠ¶æ€ä¸‹çš„è¾“å…¥
            // æ£€æŸ¥æ˜¯å¦å¯ç”¨è¾“å…¥æ³•æ”¯æŒå¹¶åŒ…å«æ‹¼éŸ³åˆ†éš”ç¬¦
            if (searchConfig.pinyin.supportInputMethod && /['`Â·,ï¼Œ]/.test(keyword)) {
                // å°è¯•æ¸…ç†æ‹¼éŸ³åˆ†éš”ç¬¦è¿›è¡Œæœç´¢
                let cleanKeyword = keyword.replace(/['`Â·,ï¼Œ\s]+/g, '');

                if (searchConfig.debug) {
                    console.log('æ£€æµ‹åˆ°è¾“å…¥æ³•çŠ¶æ€ï¼Œæ¸…ç†å:', cleanKeyword);
                }

                // å¦‚æœæ¸…ç†åçš„å…³é”®è¯ä¸åŸå…³é”®è¯ä¸åŒï¼Œä½¿ç”¨æ¸…ç†åçš„å…³é”®è¯æœç´¢
                if (cleanKeyword !== keyword) {
                    return performPinyinSearch(cleanKeyword);
                }
            }

            // å¦‚æœæœç´¢æ•°æ®è¿˜æœªåˆå§‹åŒ–ï¼Œå°è¯•åˆå§‹åŒ–
            if (searchableItems.length === 0) {
                console.log('æœç´¢æ•°æ®ä¸ºç©ºï¼Œå°è¯•åˆå§‹åŒ–');
                initSearchData();

                // å¦‚æœä»ç„¶ä¸ºç©ºï¼Œæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
                if (searchableItems.length === 0) {
                    if (searchConfig.debug) {
                        console.error('æœç´¢æ•°æ®åˆå§‹åŒ–å¤±è´¥');
                    }
                    return [];
                }
            }

            // è®°å½•ä¸€ä¸‹æœ‰å¤šå°‘å¯æœç´¢é¡¹ç›®
            if (searchConfig.debug) {
                console.log('å½“å‰å¯æœç´¢é¡¹ç›®æ•°: ' + searchableItems.length);
                console.log('å½“å‰RSSé¡¹ç›®æ•°: ' + rssItems.length);

                // ç”¨äºè°ƒè¯•çš„æ—¥å¿—
                if (keyword.length > 0) {
                    console.log('æ‰§è¡Œå…³é”®è¯æœç´¢ï¼ˆéæ‹¼éŸ³æœç´¢æ¨¡å¼ï¼‰');
                }
            }

            // æœç´¢é€»è¾‘å¢å¼ºç‰ˆ
            searchableItems.forEach(function (item, index) {
                // æ ‡é¢˜å®Œå…¨åŒ¹é…ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰
                if (item.title === keyword) {
                    item.matchType = 'exact_title';
                    item.matchWeight = 100;
                    results.push(item);
                    return;
                }

                // æ ‡é¢˜åŒ…å«åŒ¹é…
                if (item.title.includes(keyword)) {
                    item.matchType = 'title';
                    item.matchWeight = 90;
                    results.push(item);
                    return;
                }

                // æ ‡é¢˜æ‹¼éŸ³æ— å£°è°ƒåŒ¹é…ï¼ˆå¢åŠ æ­¤é€‰é¡¹ï¼‰
                if (item.titlePinyinNone && item.titlePinyinNone.includes(keyword)) {
                    item.matchType = 'pinyin_none';
                    item.matchWeight = 85;
                    results.push(item);
                    return;
                }

                // æ ‡é¢˜æ‹¼éŸ³å…¨æ‹¼åŒ¹é…
                if (item.titlePinyin && item.titlePinyin.includes(keyword)) {
                    item.matchType = 'pinyin';
                    item.matchWeight = 80;
                    results.push(item);
                    return;
                }

                // æ ‡é¢˜æ‹¼éŸ³é¦–å­—æ¯åŒ¹é… - å¢å¼ºç‰ˆ
                if (item.titlePinyinFirst && searchConfig.pinyin.enableFirstLetter) {
                    // 1. å¸¸è§„é¦–å­—æ¯åŒ¹é…
                    if (item.titlePinyinFirst.includes(keyword)) {
                        item.matchType = 'pinyin_first';
                        item.matchWeight = 60;
                        results.push(item);
                        return;
                    }

                    // 2. å¤„ç†è¿ç»­é¦–å­—æ¯è¾“å…¥ï¼ˆæ— ç©ºæ ¼ï¼‰
                    // ä¾‹å¦‚ï¼šç”¨æˆ·è¾“å…¥"zbsc"åº”è¯¥èƒ½åŒ¹é…"ç«™é•¿åšå®¢"(zhan chang bo ke)
                    let compactFirstLetters = item.titlePinyinFirst.replace(/\s+/g, '');
                    if (compactFirstLetters.includes(keyword)) {
                        item.matchType = 'pinyin_first_compact';
                        item.matchWeight = 58;
                        results.push(item);
                        return;
                    }
                }

                // å¢åŠ å•å­—æ‹¼éŸ³åŒ¹é…ï¼ˆé’ˆå¯¹å¤šå­—è¯ç»„ï¼‰
                if (keyword.length >= 2 && item.title.length >= 2) {
                    let chars = item.title.split('');
                    let singlePinyins = [];

                    try {
                        for (let i = 0; i < chars.length; i++) {
                            let char = chars[i];
                            if (/[\u4e00-\u9fa5]/.test(char)) { // æ˜¯å¦ä¸ºæ±‰å­—
                                let p = pinyinPro.pinyin(char, { toneType: 'none' });
                                if (p) {
                                    singlePinyins.push(p.toLowerCase());
                                }
                            }
                        }

                        let singlePinyinStr = singlePinyins.join('');
                        if (singlePinyinStr.includes(keyword)) {
                            item.matchType = 'single_pinyin';
                            item.matchWeight = 55;
                            results.push(item);
                            return;
                        }
                    } catch (e) {
                        if (searchConfig.debug) {
                            console.error('å•å­—æ‹¼éŸ³åŒ¹é…å‡ºé”™:', e);
                        }
                    }
                }

                // æè¿°åŒ¹é…ï¼ˆæœ€ä½ä¼˜å…ˆçº§ï¼‰
                if (item.desc.includes(keyword)) {
                    item.matchType = 'desc';
                    item.matchWeight = 40;
                    results.push(item);
                    return;
                }
            });

            // å¦‚æœå¯ç”¨äº†RSSæœç´¢ï¼Œæœç´¢RSSæ•°æ®
            if (searchConfig.rss && searchConfig.rss.enabled && rssItems.length > 0) {
                rssItems.forEach(function (item) {
                    // æ ‡é¢˜å®Œå…¨åŒ¹é…
                    if (item.title === keyword) {
                        item.matchType = 'rss_exact_title';
                        item.matchWeight = 95;
                        item.isRss = true;
                        results.push(item);
                        return;
                    }

                    // æ ‡é¢˜åŒ…å«åŒ¹é…
                    if (item.title.includes(keyword)) {
                        item.matchType = 'rss_title';
                        item.matchWeight = 85;
                        item.isRss = true;
                        results.push(item);
                        return;
                    }

                    // æ ‡é¢˜æ‹¼éŸ³åŒ¹é…
                    if (item.titlePinyin && item.titlePinyin.includes(keyword)) {
                        item.matchType = 'rss_pinyin';
                        item.matchWeight = 75;
                        item.isRss = true;
                        results.push(item);
                        return;
                    }

                    // æ ‡é¢˜æ‹¼éŸ³é¦–å­—æ¯åŒ¹é…
                    if (item.titlePinyinFirst && searchConfig.pinyin.enableFirstLetter) {
                        if (item.titlePinyinFirst.includes(keyword)) {
                            item.matchType = 'rss_pinyin_first';
                            item.matchWeight = 55;
                            item.isRss = true;
                            results.push(item);
                            return;
                        }

                        // å¤„ç†è¿ç»­é¦–å­—æ¯è¾“å…¥ï¼ˆæ— ç©ºæ ¼ï¼‰
                        let compactFirstLetters = item.titlePinyinFirst.replace(/\s+/g, '');
                        if (compactFirstLetters.includes(keyword)) {
                            item.matchType = 'rss_pinyin_first_compact';
                            item.matchWeight = 53;
                            item.isRss = true;
                            results.push(item);
                            return;
                        }
                    }

                    // å†…å®¹åŒ¹é…
                    if (item.summary && item.summary.includes(keyword)) {
                        item.matchType = 'rss_content';
                        item.matchWeight = 45;
                        item.isRss = true;
                        results.push(item);
                        return;
                    }

                    // åˆ†ç±»æ ‡ç­¾åŒ¹é…
                    if (item.categories && item.categories.includes(keyword)) {
                        item.matchType = 'rss_category';
                        item.matchWeight = 50;
                        item.isRss = true;
                        results.push(item);
                        return;
                    }
                });
            }

            // æŒ‰åŒ¹é…æƒé‡æ’åº
            results.sort(function (a, b) {
                return b.matchWeight - a.matchWeight;
            });

            if (searchConfig.debug) {
                console.log('æœç´¢ç»“æœæ•°: ' + results.length);
                if (results.length > 0) {
                    console.log('ç¬¬ä¸€ä¸ªç»“æœ: ' + results[0].title + ', åŒ¹é…ç±»å‹: ' + results[0].matchType);
                }
            }

            return results;
        }

        // æœç´¢è¾“å…¥ç›‘å¬
        document.getElementById('txt').addEventListener('input', function () {
            var searchKeyword = this.value.trim();
            var searchResults = document.getElementById('searchResults');
            var searchResultsContainer = searchResults.querySelector('.box-card');
            searchResultsContainer.innerHTML = '';

            if (searchKeyword.length === 0) {
                searchResults.style.display = 'none';
                return;
            }

            // æ”¯æŒè¾“å…¥æ³•æ‹¼éŸ³çŠ¶æ€ä¸‹çš„æœç´¢
            // å½“ç”¨æˆ·æ­£åœ¨è¾“å…¥æ‹¼éŸ³ä½†å°šæœªé€‰æ‹©æ±‰å­—æ—¶ï¼Œä¹Ÿè¿›è¡Œæœç´¢
            var matchedItems = performSearch(searchKeyword);

            // å¦‚æœæ²¡æœ‰æœç´¢ç»“æœå¹¶ä¸”è¾“å…¥å†…å®¹åŒ…å«æ‹¼éŸ³å­—ç¬¦ï¼Œå°è¯•ä½œä¸ºæ‹¼éŸ³æœç´¢
            if (matchedItems.length === 0 && /[a-zA-Z]/.test(searchKeyword) && searchConfig.pinyin.enabled) {
                // æ¸…ç†è¾“å…¥æ³•çŠ¶æ€ä¸‹çš„åˆ†éš”ç¬¦ï¼ˆå¦‚ z'z'b'kï¼‰
                let cleanKeyword = searchKeyword.replace(/['`Â·,ï¼Œ\s]+/g, '');

                if (searchConfig.debug) {
                    console.log('å°è¯•ä½œä¸ºæ‹¼éŸ³æœç´¢:', searchKeyword, 'â†’', cleanKeyword);
                }

                // å°†æ¸…ç†åçš„è¾“å…¥è§†ä¸ºæ‹¼éŸ³ï¼Œå†æ¬¡æœç´¢
                matchedItems = performPinyinSearch(cleanKeyword);
            }

            if (matchedItems.length > 0) {
                searchResults.style.display = 'block';

                // æ¸…ç©ºæœç´¢ç»“æœå®¹å™¨å†…çš„æ‰€æœ‰å†…å®¹
                searchResultsContainer.innerHTML = '';

                // é™åˆ¶æœ€å¤šæ˜¾ç¤ºç»“æœæ•°é‡
                matchedItems = matchedItems.slice(0, searchConfig.maxResults);

                // åˆ†ç¦»ç«™å†…æœç´¢ç»“æœå’ŒRSSæœç´¢ç»“æœ
                var regularResults = matchedItems.filter(item => !item.isRss);
                var rssResults = matchedItems.filter(item => item.isRss);

                var displayedItems = new Set();

                // å…ˆæ˜¾ç¤ºç«™å†…æœç´¢ç»“æœ
                if (regularResults.length > 0) {
                    regularResults.forEach(function (item) {
                        // å…‹éš†å…ƒç´ ä»¥é¿å…ç§»åŠ¨åŸå§‹å…ƒç´ 
                        var clonedItem = item.element.cloneNode(true);

                        // è·å–æ ‡é¢˜å…ƒç´ å¹¶æ ¹æ®åŒ¹é…ç±»å‹æ·»åŠ é«˜äº®
                        var titleElem = clonedItem.querySelector('.logo span');
                        if (titleElem && item.matchType && searchConfig.showMatchType) {
                            var matchTypeText = '';
                            var matchColor = '#999';

                            switch (item.matchType) {
                                case 'exact_title':
                                    matchTypeText = ' [ç²¾å‡†åŒ¹é…]';
                                    matchColor = searchConfig.style.exactMatchColor;
                                    break;
                                case 'pinyin_none':
                                    matchTypeText = ' [æ‹¼éŸ³åŒ¹é…]';
                                    break;
                                case 'pinyin':
                                    matchTypeText = ' [æ‹¼éŸ³åŒ¹é…]';
                                    break;
                                case 'pinyin_first':
                                    matchTypeText = ' [é¦–å­—æ¯åŒ¹é…]';
                                    break;
                                case 'pinyin_first_compact':
                                    matchTypeText = ' [é¦–å­—æ¯åŒ¹é…]';
                                    break;
                                case 'pinyin_input':
                                    matchTypeText = ' [æ‹¼éŸ³è¾“å…¥åŒ¹é…]';
                                    matchColor = searchConfig.style.pinyinMatchColor;
                                    break;
                                case 'pinyin_input_first':
                                    matchTypeText = ' [æ‹¼éŸ³é¦–å­—æ¯åŒ¹é…]';
                                    matchColor = searchConfig.style.pinyinMatchColor;
                                    break;
                                case 'pinyin_input_start':
                                    matchTypeText = ' [æ‹¼éŸ³å‰ç¼€åŒ¹é…]';
                                    matchColor = searchConfig.style.pinyinMatchColor;
                                    break;
                                case 'pinyin_input_char':
                                    matchTypeText = ' [å•å­—æ‹¼éŸ³åŒ¹é…]';
                                    matchColor = searchConfig.style.pinyinMatchColor;
                                    break;
                                case 'single_pinyin':
                                    matchTypeText = ' [è¯ç»„æ‹¼éŸ³]';
                                    break;
                                case 'desc':
                                    matchTypeText = ' [æè¿°åŒ¹é…]';
                                    matchColor = searchConfig.style.descMatchColor;
                                    break;
                            }

                            if (matchTypeText) {
                                var small = document.createElement('small');
                                small.style.fontSize = '0.7em';
                                small.style.color = matchColor;
                                small.textContent = matchTypeText;
                                titleElem.appendChild(small);
                            }
                        }

                        // åˆ¤æ–­æ˜¯å¦å·²ç»æ˜¾ç¤ºè¿‡è¯¥item
                        if (!displayedItems.has(item.title)) {
                            searchResultsContainer.appendChild(clonedItem);
                            displayedItems.add(item.title);
                        }
                    });
                }

                // å¦‚æœæœ‰RSSç»“æœï¼Œæ·»åŠ åˆ†éš”çº¿å’ŒRSSç»“æœæ ‡é¢˜
                if (rssResults.length > 0) {
                    // ç¡®ä¿å¸¸è§„ç»“æœåæœ‰ä¸€ä¸ªæ¸…é™¤æµ®åŠ¨çš„å…ƒç´ 
                    if (regularResults.length > 0) {
                        var clearFloats = document.createElement('div');
                        clearFloats.style.clear = 'both';
                        clearFloats.style.width = '100%';
                        clearFloats.style.height = '1px';
                        clearFloats.style.display = 'block';
                        searchResultsContainer.appendChild(clearFloats);
                    }

                    // åˆ›å»ºä¸€ä¸ªæ–°çš„å¤–éƒ¨å®¹å™¨ï¼Œå®Œå…¨ç‹¬ç«‹äºç«™å†…æœç´¢ç»“æœ
                    var rssOuterContainer = document.createElement('div');
                    rssOuterContainer.className = 'rss-outer-container';

                    // æ·»åŠ RSSæ ‡è¯†å›¾æ ‡
                    var rssIcon = document.createElement('span');
                    rssIcon.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="#3273dc" style="vertical-align: middle; margin-right: 5px;"><path d="M6.503 20.752c0 1.794-1.456 3.248-3.251 3.248-1.796 0-3.252-1.454-3.252-3.248 0-1.794 1.456-3.248 3.252-3.248 1.795.001 3.251 1.454 3.251 3.248zm-6.503-12.572v4.811c6.05.062 10.96 4.966 11.022 11.009h4.817c-.062-8.71-7.118-15.758-15.839-15.82zm0-3.368c10.58.046 19.152 8.594 19.183 19.188h4.817c-.03-13.231-10.755-23.954-24-24v4.812z"/></svg>';
                    rssIcon.style.marginRight = '5px';

                    // æ·»åŠ RSSç»“æœæ ‡é¢˜
                    var rssResultsTitle = document.createElement('div');
                    rssResultsTitle.className = 'rss-results-title';

                    // å°†RSSå›¾æ ‡æ·»åŠ åˆ°æ ‡é¢˜
                    rssResultsTitle.appendChild(rssIcon);
                    rssResultsTitle.appendChild(document.createTextNode(`RSSæ–‡ç« æœç´¢ç»“æœ (${rssResults.length}æ¡)`));

                    rssOuterContainer.appendChild(rssResultsTitle);

                    // æ·»åŠ RSSç»“æœå®¹å™¨ - ä½¿ç”¨ç‹¬ç«‹å®¹å™¨ç¡®ä¿å®Œå…¨å¦èµ·ä¸€è¡Œ
                    var rssResultsContainer = document.createElement('div');
                    rssResultsContainer.className = 'rss-results-container';
                    // å¼ºåˆ¶ä½¿ç”¨å•åˆ—å¸ƒå±€ï¼Œä¸ä½¿ç”¨ç½‘æ ¼å¸ƒå±€
                    rssResultsContainer.style.display = 'flex';
                    rssResultsContainer.style.flexDirection = 'column';
                    rssResultsContainer.style.gridTemplateColumns = 'none';
                    rssOuterContainer.appendChild(rssResultsContainer);

                    // å°†æ•´ä¸ªRSSå¤–éƒ¨å®¹å™¨æ·»åŠ åˆ°æœç´¢ç»“æœå®¹å™¨ä¸­ï¼Œä½†ç¡®ä¿å®ƒä¸ç»§æ‰¿ç½‘æ ¼å¸ƒå±€
                    // å…ˆåˆ›å»ºä¸€ä¸ªåŒ…è£…å®¹å™¨ï¼Œç¡®ä¿RSSç»“æœä¸å—ç½‘æ ¼å¸ƒå±€å½±å“
                    var rssWrapper = document.createElement('div');
                    rssWrapper.className = 'rss-wrapper';

                    rssWrapper.appendChild(rssOuterContainer);
                    searchResultsContainer.appendChild(rssWrapper);

                    // æ˜¾ç¤ºRSSæœç´¢ç»“æœ
                    rssResults.forEach(function (item) {
                        // åˆ›å»ºRSSé¡¹ç›®çš„æ˜¾ç¤ºå…ƒç´ 
                        var rssItemDiv = document.createElement('div');
                        rssItemDiv.className = 'rss-item';

                        // åˆ›å»ºé“¾æ¥å…ƒç´ 
                        var rssLink = document.createElement('a');
                        rssLink.href = item.link;
                        rssLink.target = '_blank';
                        rssLink.rel = 'noopener external nofollow noreferrer';

                        // åˆ›å»ºæ ‡é¢˜å…ƒç´ 
                        var rssTitle = document.createElement('div');
                        rssTitle.className = 'rss-title';

                        // åˆ›å»ºæ ‡é¢˜æ–‡æœ¬
                        var rssTitleText = document.createElement('span');
                        rssTitleText.textContent = item.title.charAt(0).toUpperCase() + item.title.slice(1); // é¦–å­—æ¯å¤§å†™
                        rssTitle.appendChild(rssTitleText);

                        // æ·»åŠ åŒ¹é…ç±»å‹æ ‡ç­¾
                        if (item.matchType && searchConfig.showMatchType) {
                            var matchTypeText = '';
                            var matchColor = '#999';

                            switch (item.matchType) {
                                case 'rss_exact_title':
                                    matchTypeText = ' [ç²¾å‡†åŒ¹é…]';
                                    matchColor = searchConfig.style.rssMatchColor;
                                    break;
                                case 'rss_title':
                                    matchTypeText = ' [æ ‡é¢˜åŒ¹é…]';
                                    matchColor = searchConfig.style.rssMatchColor;
                                    break;
                                case 'rss_pinyin':
                                    matchTypeText = ' [æ‹¼éŸ³åŒ¹é…]';
                                    matchColor = searchConfig.style.rssMatchColor;
                                    break;
                                case 'rss_pinyin_first':
                                    matchTypeText = ' [é¦–å­—æ¯åŒ¹é…]';
                                    matchColor = searchConfig.style.rssMatchColor;
                                    break;
                                case 'rss_content':
                                    matchTypeText = ' [å†…å®¹åŒ¹é…]';
                                    matchColor = searchConfig.style.rssMatchColor;
                                    break;
                                case 'rss_category':
                                    matchTypeText = ' [åˆ†ç±»åŒ¹é…]';
                                    matchColor = searchConfig.style.rssMatchColor;
                                    break;
                            }

                            if (matchTypeText) {
                                var small = document.createElement('small');
                                small.style.fontSize = '0.7em';
                                small.style.color = matchColor;
                                small.textContent = matchTypeText;
                                rssTitle.appendChild(small);
                            }
                        }

                        // åˆ›å»ºæ‘˜è¦å…ƒç´ 
                        var rssSummary = document.createElement('div');
                        rssSummary.className = 'rss-summary';

                        // æ¸…ç†HTMLæ ‡ç­¾ï¼Œåªä¿ç•™çº¯æ–‡æœ¬
                        var summaryText = item.summary.replace(/<[^>]*>/g, '');
                        // é™åˆ¶æ‘˜è¦é•¿åº¦
                        if (summaryText.length > 150) {
                            summaryText = summaryText.substring(0, 150) + '...';
                        }
                        rssSummary.textContent = summaryText;

                        // åˆ›å»ºæ—¥æœŸå’Œåˆ†ç±»å…ƒç´ 
                        var rssInfo = document.createElement('div');
                        rssInfo.className = 'rss-info';

                        // æ ¼å¼åŒ–æ—¥æœŸ
                        var pubDate = '';
                        try {
                            pubDate = new Date(item.published).toLocaleDateString();
                        } catch (e) {
                            pubDate = item.published;
                        }

                        // æ·»åŠ æ¥æºä¿¡æ¯
                        var sourceText = item.sourceHost || 'æœªçŸ¥æ¥æº';
                        rssInfo.textContent = `${pubDate} Â· ${sourceText}`;

                        // å¦‚æœæœ‰åˆ†ç±»ï¼Œæ·»åŠ åˆ†ç±»ä¿¡æ¯
                        if (item.categories && item.categories.length > 0) {
                            rssInfo.textContent += ` Â· ${item.categories}`;
                        }

                        // ç»„è£…RSSé¡¹ç›®
                        rssLink.appendChild(rssTitle);
                        rssLink.appendChild(rssSummary);
                        rssLink.appendChild(rssInfo);
                        rssItemDiv.appendChild(rssLink);

                        // æ·»åŠ åˆ°RSSç»“æœå®¹å™¨
                        if (!displayedItems.has(item.link)) {
                            rssResultsContainer.appendChild(rssItemDiv);
                            displayedItems.add(item.link);
                        }
                    });
                }
            } else {
                searchResults.style.display = 'block';
                var noResultItem = document.createElement('div');
                noResultItem.textContent = 'å°å¼ æé†’ï¼šæœªæ‰¾åˆ°ç›¸å…³ç»“æœï¼Œå¯ä»¥å°è¯•æ‹¼éŸ³æˆ–ä¸åŒå…³é”®è¯æœç´¢';
                noResultItem.classList.add('notfind');
                searchResultsContainer.appendChild(noResultItem);
            }
        });

        // åŠ è½½RSSæ•°æ®
        function loadRssData() {
            if (!searchConfig.rss.sources || searchConfig.rss.sources.length === 0) {
                if (searchConfig.debug) {
                    console.log('æœªé…ç½®RSSæº');
                }
                return;
            }

            // éå†æ‰€æœ‰RSSæº
            searchConfig.rss.sources.forEach(function (rssUrl) {
                if (searchConfig.debug) {
                    console.log('åŠ è½½RSSæº: ' + rssUrl);
                }

                // ä½¿ç”¨CORSä»£ç†è§£å†³è·¨åŸŸé—®é¢˜
                const corsProxyUrl = 'https://api.allorigins.win/raw?url=';
                const fetchUrl = corsProxyUrl + encodeURIComponent(rssUrl);

                // ä½¿ç”¨fetch APIè·å–RSSæ•°æ®
                fetch(fetchUrl)
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Network response was not ok');
                        }
                        return response.text();
                    })
                    .then(str => {
                        try {
                            return new window.DOMParser().parseFromString(str, "text/xml");
                        } catch (e) {
                            console.error('è§£æXMLå¤±è´¥:', e);
                            throw e;
                        }
                    })
                    .then(data => {
                        if (searchConfig.debug) {
                            console.log('RSSæ•°æ®åŠ è½½æˆåŠŸ: ' + rssUrl);
                        }

                        // è§£æRSSæ•°æ®
                        parseRssData(data, rssUrl);
                    })
                    .catch(error => {
                        console.error('åŠ è½½RSSæ•°æ®å¤±è´¥ (' + rssUrl + '):', error);

                        // å°è¯•ä½¿ç”¨å¤‡ç”¨CORSä»£ç†
                        const backupProxyUrl = 'https://corsproxy.io/?';
                        const backupFetchUrl = backupProxyUrl + encodeURIComponent(rssUrl);

                        console.log('å°è¯•ä½¿ç”¨å¤‡ç”¨ä»£ç†é‡æ–°åŠ è½½: ' + rssUrl);

                        fetch(backupFetchUrl)
                            .then(response => response.text())
                            .then(str => new window.DOMParser().parseFromString(str, "text/xml"))
                            .then(data => {
                                if (searchConfig.debug) {
                                    console.log('ä½¿ç”¨å¤‡ç”¨ä»£ç†æˆåŠŸåŠ è½½RSS: ' + rssUrl);
                                }
                                parseRssData(data, rssUrl);
                            })
                            .catch(error => {
                                console.error('å¤‡ç”¨ä»£ç†åŠ è½½å¤±è´¥ (' + rssUrl + '):', error);
                            });
                    });
            });
        }

        // è§£æRSSæ•°æ®
        function parseRssData(xml, rssUrl) {
            try {
                // è·å–RSSæºçš„åŸŸåï¼Œç”¨äºæ˜¾ç¤ºæ¥æº
                let sourceHost = '';
                try {
                    const url = new URL(rssUrl);
                    sourceHost = url.hostname;
                } catch (e) {
                    sourceHost = rssUrl;
                }

                // å°è¯•è§£æAtomæ ¼å¼
                const entries = xml.querySelectorAll('entry');
                if (entries.length > 0) {
                    if (searchConfig.debug) {
                        console.log('æ£€æµ‹åˆ°Atomæ ¼å¼RSSï¼Œæ¡ç›®æ•°: ' + entries.length);
                    }

                    // é™åˆ¶æ¡ç›®æ•°é‡
                    const maxEntries = Math.min(entries.length, searchConfig.rss.maxEntries || 50);

                    for (let i = 0; i < maxEntries; i++) {
                        const entry = entries[i];
                        const title = entry.querySelector('title') ? entry.querySelector('title').textContent : '';
                        const link = entry.querySelector('link') ? entry.querySelector('link').getAttribute('href') : '';
                        const summary = entry.querySelector('summary') ? entry.querySelector('summary').textContent : '';
                        const content = entry.querySelector('content') ? entry.querySelector('content').textContent : summary;
                        const published = entry.querySelector('published') ? entry.querySelector('published').textContent : '';
                        const updated = entry.querySelector('updated') ? entry.querySelector('updated').textContent : '';

                        // è·å–åˆ†ç±»æ ‡ç­¾
                        const categories = [];
                        entry.querySelectorAll('category').forEach(cat => {
                            categories.push(cat.getAttribute('term'));
                        });

                        // åˆ›å»ºRSSé¡¹ç›®å¯¹è±¡
                        const rssItem = {
                            title: title.toLowerCase(),
                            link: link,
                            summary: summary.toLowerCase(),
                            content: content.toLowerCase(),
                            published: published,
                            updated: updated,
                            categories: categories.join(', ').toLowerCase(),
                            source: 'atom',
                            sourceUrl: rssUrl,
                            sourceHost: sourceHost,
                            titlePinyin: '',
                            titlePinyinFirst: '',
                            titlePinyinNone: ''
                        };

                        // ç”Ÿæˆæ‹¼éŸ³æ•°æ®
                        try {
                            if (window.pinyinPro) {
                                rssItem.titlePinyin = pinyinPro.pinyin(title, { toneType: 'none' }).toLowerCase();
                                rssItem.titlePinyinFirst = pinyinPro.pinyin(title, { pattern: 'first', toneType: 'none' }).toLowerCase();
                                rssItem.titlePinyinNone = rssItem.titlePinyin;
                            }
                        } catch (e) {
                            if (searchConfig.debug) {
                                console.error('RSSæ ‡é¢˜æ‹¼éŸ³è½¬æ¢å‡ºé”™:', e);
                            }
                        }

                        // æ·»åŠ åˆ°RSSé¡¹ç›®åˆ—è¡¨
                        rssItems.push(rssItem);
                    }
                } else {
                    // å°è¯•è§£æRSS 2.0æ ¼å¼
                    const items = xml.querySelectorAll('item');
                    if (items.length > 0) {
                        if (searchConfig.debug) {
                            console.log('æ£€æµ‹åˆ°RSS 2.0æ ¼å¼ï¼Œæ¡ç›®æ•°: ' + items.length);
                        }

                        // é™åˆ¶æ¡ç›®æ•°é‡
                        const maxItems = Math.min(items.length, searchConfig.rss.maxEntries || 50);

                        for (let i = 0; i < maxItems; i++) {
                            const item = items[i];
                            const title = item.querySelector('title') ? item.querySelector('title').textContent : '';
                            const link = item.querySelector('link') ? item.querySelector('link').textContent : '';
                            const description = item.querySelector('description') ? item.querySelector('description').textContent : '';
                            const pubDate = item.querySelector('pubDate') ? item.querySelector('pubDate').textContent : '';

                            // è·å–åˆ†ç±»æ ‡ç­¾
                            const categories = [];
                            item.querySelectorAll('category').forEach(cat => {
                                categories.push(cat.textContent);
                            });

                            // åˆ›å»ºRSSé¡¹ç›®å¯¹è±¡
                            const rssItem = {
                                title: title.toLowerCase(),
                                link: link,
                                summary: description.toLowerCase(),
                                content: description.toLowerCase(),
                                published: pubDate,
                                updated: pubDate,
                                categories: categories.join(', ').toLowerCase(),
                                source: 'rss',
                                sourceUrl: rssUrl,
                                sourceHost: sourceHost,
                                titlePinyin: '',
                                titlePinyinFirst: '',
                                titlePinyinNone: ''
                            };

                            // ç”Ÿæˆæ‹¼éŸ³æ•°æ®
                            try {
                                if (window.pinyinPro) {
                                    rssItem.titlePinyin = pinyinPro.pinyin(title, { toneType: 'none' }).toLowerCase();
                                    rssItem.titlePinyinFirst = pinyinPro.pinyin(title, { pattern: 'first', toneType: 'none' }).toLowerCase();
                                    rssItem.titlePinyinNone = rssItem.titlePinyin;
                                }
                            } catch (e) {
                                if (searchConfig.debug) {
                                    console.error('RSSæ ‡é¢˜æ‹¼éŸ³è½¬æ¢å‡ºé”™:', e);
                                }
                            }

                            // æ·»åŠ åˆ°RSSé¡¹ç›®åˆ—è¡¨
                            rssItems.push(rssItem);
                        }
                    } else {
                        if (searchConfig.debug) {
                            console.error('æœªè¯†åˆ«çš„RSSæ ¼å¼');
                        }
                    }
                }

                if (searchConfig.debug) {
                    console.log('æˆåŠŸè§£æRSSæ•°æ®ï¼Œå…± ' + rssItems.length + ' æ¡');
                }
            } catch (error) {
                console.error('è§£æRSSæ•°æ®å‡ºé”™:', error);
            }
        }
    </script>
    <!-- end -->

    <!-- æ”¶è—æ·»åŠ å¼¹çª— -->
    <div id="fav-modal"
        style="display:none;position:fixed;left:0;top:0;width:100vw;height:100vh;background:rgba(0,0,0,0.3);z-index:9999;align-items:center;justify-content:center;">
        <div style="background:#fff;padding:24px 32px;border-radius:10px;min-width:320px;box-shadow:0 2px 16px #0001;">
            <h3 style="margin-bottom:16px;">æ·»åŠ æ”¶è—</h3>
            <div style="margin-bottom:10px;">
                <input id="fav-title" placeholder="ç½‘ç«™åç§°" style="width:100%;padding:6px 8px;">
            </div>
            <div style="margin-bottom:10px;">
                <input id="fav-url" placeholder="ç½‘å€ï¼ˆå«http/httpsï¼‰" style="width:100%;padding:6px 8px;">
            </div>
            <div style="margin-bottom:10px;">
                <input id="fav-icon" placeholder="å›¾æ ‡URLï¼ˆå¯é€‰ï¼‰" style="width:100%;padding:6px 8px;">
            </div>
            <div style="margin-bottom:10px;">
                <input id="fav-desc" placeholder="æè¿°ï¼ˆå¯é€‰ï¼‰" style="width:100%;padding:6px 8px;">
            </div>
            <div style="text-align:right;">
                <button onclick="closeFavModal()" style="margin-right:10px;">å–æ¶ˆ</button>
                <button onclick="saveFav()"
                    style="background:#3385ff;color:#fff;border:none;padding:6px 18px;border-radius:6px;">ä¿å­˜</button>
            </div>
        </div>
    </div>

    <!-- é¡¶éƒ¨ç™»å½•æŒ‰é’® -->
    <div id="top-login-btn" style="position:fixed;top:18px;right:32px;z-index:10000;">
        <button onclick="showLoginModal()"
            style="background:#3385ff;color:#fff;border:none;padding:8px 22px;border-radius:20px;font-size:16px;box-shadow:0 2px 8px #0001;cursor:pointer;">ç™»å½•</button>
    </div>

    <!-- ç™»å½•å¼¹çª— -->
    <div id="login-modal"
        style="display:none;position:fixed;left:0;top:0;width:100vw;height:100vh;background:rgba(0,0,0,0.3);z-index:9999;align-items:center;justify-content:center;">
        <div
            style="background:#fff;padding:32px 36px;border-radius:12px;min-width:320px;box-shadow:0 2px 16px #0001;display:flex;flex-direction:column;align-items:center;">
            <h3 style="margin-bottom:18px;">ç”¨æˆ·ç™»å½•</h3>
            <p>æ³¨å†ŒåŠŸèƒ½å®Œå–„ä¸­~~</p>
            <input id="login-email" type="email" placeholder="é‚®ç®±"
                style="width:220px;padding:8px 10px;margin-bottom:12px;">
            <input id="login-password" type="password" placeholder="å¯†ç "
                style="width:220px;padding:8px 10px;margin-bottom:18px;">
            <div style="width:100%;display:flex;justify-content:space-between;">
                <button onclick="closeLoginModal()"
                    style="background:#eee;border:none;padding:6px 18px;border-radius:6px;">å–æ¶ˆ</button>
                <button onclick="login()"
                    style="background:#3385ff;color:#fff;border:none;padding:6px 18px;border-radius:6px;">ç™»å½•</button>
            </div>
        </div>
    </div>

    <!-- æ·»åŠ æ”¶è—å¼¹çª—ï¼ˆæ–°ç‰ˆï¼‰ -->
    <div id="fav-form-modal"
        style="display:none;position:fixed;left:0;top:0;width:100vw;height:100vh;background:rgba(0,0,0,0.3);z-index:9999;align-items:center;justify-content:center;">
        <div
            style="background:#fff;padding:32px 36px;border-radius:12px;min-width:340px;box-shadow:0 2px 16px #0001;display:flex;flex-direction:column;align-items:center;">
            <h3 style="margin-bottom:18px;">æ·»åŠ æ”¶è—</h3>
            <div style="width:100%;margin-bottom:12px;">
                <label>*URLé“¾æ¥åœ°å€:</label>
                <input id="fav-form-url" type="text" placeholder="å®Œæ•´é“¾æ¥æˆ–åŸŸå"
                    style="width:100%;padding:8px 10px;margin-top:4px;">
                <button type="button" onclick="autoGetIcon()"
                    style="margin-top:6px;float:right;font-size:12px;">è‡ªåŠ¨è·å–</button>
            </div>
            <div style="width:100%;margin-bottom:12px;">
                <label>*ç½‘ç«™åç§°:</label>
                <input id="fav-form-title" type="text" placeholder="ç½‘ç«™åç§°"
                    style="width:100%;padding:8px 10px;margin-top:4px;">
            </div>
            <div style="width:100%;margin-bottom:12px;">
                <label>ç½‘ç«™å›¾æ ‡:</label>
                <input id="fav-form-icon" type="text" placeholder="å¡«å†™å›¾æ ‡çš„URLåœ°å€"
                    style="width:100%;padding:8px 10px;margin-top:4px;">
                <div style="font-size:12px;color:#f55;margin-top:2px;">
                    å¡«å†™å›¾æ ‡çš„URLåœ°å€ï¼Œå¦‚ï¼šhttp://www.xxx.com/logo.png<br>éƒ¨åˆ†ç½‘ç«™æ— æ³•è‡ªåŠ¨è·å–ï¼Œè¯·æ‰‹åŠ¨å¡«å†™</div>
            </div>
            <div style="width:100%;margin-bottom:12px;">
                <label>ç½‘ç«™æè¿°:</label>
                <input id="fav-form-desc" type="text" placeholder="ç½‘ç«™æè¿°ï¼ˆå¯é€‰ï¼‰"
                    style="width:100%;padding:8px 10px;margin-top:4px;">
            </div>
            <div style="width:100%;display:flex;justify-content:space-between;margin-top:10px;">
                <button type="button" onclick="closeFavForm()"
                    style="background:#eee;border:none;padding:6px 18px;border-radius:6px;">å–æ¶ˆ</button>
                <button type="button" onclick="submitFavForm()"
                    style="background:#38cfa6;color:#fff;border:none;padding:6px 18px;border-radius:6px;">æäº¤</button>
            </div>
        </div>
    </div>

    <!-- é€‰æ‹©å·²æœ‰ç«™ç‚¹å¼¹çª— -->
    <div id="select-site-modal"
        style="display:none;position:fixed;left:0;top:0;width:100vw;height:100vh;background:rgba(0,0,0,0.3);z-index:9999;align-items:center;justify-content:center;">
        <div
            style="background:#fff;padding:32px 36px;border-radius:12px;min-width:340px;box-shadow:0 2px 16px #0001;display:flex;flex-direction:column;align-items:center;max-height:80vh;overflow:auto;">
            <h3 style="margin-bottom:18px;">é€‰æ‹©å·²æœ‰ç«™ç‚¹æ”¶è—</h3>
            <div id="site-list" style="width:100%;max-height:300px;overflow:auto;margin-bottom:16px;"></div>
            <div style="width:100%;display:flex;justify-content:space-between;">
                <button type="button" onclick="closeSelectSiteModal()"
                    style="background:#eee;border:none;padding:6px 18px;border-radius:6px;">å–æ¶ˆ</button>
                <button type="button" onclick="addSelectedSitesToFav()"
                    style="background:#3385ff;color:#fff;border:none;padding:6px 18px;border-radius:6px;">æ·»åŠ åˆ°æˆ‘çš„æ”¶è—</button>
            </div>
        </div>
    </div>

    <style>
        /* çˆ¶å®¹å™¨è®¾ç½® flex å¸ƒå±€ï¼Œå®ç°å¤šè¡Œæ’åˆ— */
        #fav-list {
            margin-top: 16px;
            flex-wrap: wrap;
            display: grid;
            grid-template-columns: repeat(2, minmax(0, 1fr));
            gap: 10px;
        }

        .fav-card {
            cursor: pointer;
            padding: 5px;
            border-radius: 8px;
            border: 1px solid #d4d7dd;
            background-color: #ffffff;
            background: var(--BoxItemBackground-color);
            position: relative;
            /* flex: 0 0 25%; */
            /* max-width: 25%; */
        }

        /* é¼ æ ‡æ‚¬åœå¡ç‰‡åŠ¨ç”» */
        .fav-card:hover {
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            transform: translateY(-2px);
        }

        #fav-add-card {
            border: 1px dashed rgb(188, 220, 255);
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: center;
            background: #ffffff;
        }

        /* é“¾æ¥å®¹å™¨è®¾ç½® flexï¼Œè®©å›¾æ ‡å’Œæ–‡å­—å‚ç›´å±…ä¸­ */
        .fav-link {
            box-sizing: border-box;
            display: flex;
            position: relative;
            flex-direction: row;
            justify-content: center;
            align-items: center;
        }

        /* å›¾æ ‡æ ·å¼ï¼Œæ§åˆ¶å°ºå¯¸ */
        .fav-icon {
            display: block;
            width: auto;
            height: 90%;
            width: 32px;
            height: 32px;
            position: relative;
            object-fit: cover;
            border-radius: 6px;
        }

        .fav-context {
            padding-left: 7px;
        }

        .fav-title {
            font-weight: bold;
            text-overflow: ellipsis;
            overflow: hidden;
            word-break: break-all;
            white-space: nowrap;
            color: var(--Body-font-color);
            -webkit-line-clamp: 1;
            line-clamp: 1;
            display: -webkit-box;
            -webkit-box-orient: vertical;
        }

        .fav-desc {
            text-overflow: ellipsis;
            transition: .3s;
            font-size: 12px;
            overflow-wrap: break-word;
            display: -webkit-box;
            -webkit-box-orient: vertical;
            overflow: hidden;
            -webkit-line-clamp: 1;
            line-clamp: 1;
            line-height: 1.4;
            color: #888;
            /* white-space: nowrap; */
        }

        .fav-remove {
            position: absolute;
            top: 4px;
            right: 4px;
            cursor: pointer;
            width: 14px;
            height: 14px;
            color: #ffffff;
            line-height: 14px;
            text-align: center;
            border-radius: 50px;
            background: #ff0000;
            font-size: 20px;
            z-index: 2;
        }
    </style>

    <script type="module">
        // å¼•å…¥Firebaseç›¸å…³SDK
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-app.js";
        import { getAuth, onAuthStateChanged, signInWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, setDoc, updateDoc, arrayUnion, arrayRemove } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDiz-O33R3gAm4SfWyh8lSKMX-_4HdPrvg",
            authDomain: "excel-6ffce.firebaseapp.com",
            projectId: "excel-6ffce",
            storageBucket: "excel-6ffce.firebasestorage.app",
            messagingSenderId: "380737839136",
            appId: "1:380737839136:web:1f1ab3e046b761106c5c45",
            measurementId: "G-WXCMT6NDXZ"
        };

        // åˆå§‹åŒ–Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        let currentUid = null;
        let favsCache = [];
        window.isCustomizing = false;

        // ç™»å½•çŠ¶æ€åˆ‡æ¢æ—¶ï¼Œæ§åˆ¶æŒ‰é’®å’Œå¼¹çª—æ˜¾ç¤º
        function updateLoginUI(loggedIn) {
            document.getElementById('top-login-btn').style.display = loggedIn ? 'none' : 'block';
            if (loggedIn) closeLoginModal();
        }

        // ç›‘å¬ç™»å½•çŠ¶æ€å˜åŒ–
        onAuthStateChanged(auth, async (user) => {
            if (user) {
                updateLoginUI(true);
                document.getElementById('my-fav-box').style.display = 'block';
                currentUid = user.uid;
                await loadFavsFromCloud();
            } else {
                updateLoginUI(false);
                document.getElementById('my-fav-box').style.display = 'none';
                currentUid = null;
                favsCache = [];
                renderFavs();
            }
        });

        // åŠ è½½äº‘ç«¯æ”¶è—
        async function loadFavsFromCloud() {
            if (!currentUid) return;
            const userDoc = doc(db, 'userFavs', currentUid);
            try {
                const snap = await getDoc(userDoc);
                favsCache = (snap.exists() && snap.data().favs) ? snap.data().favs : [];
                renderFavs();
            } catch (e) {
                favsCache = [];
                renderFavs();
            }
        }

        // ä¿å­˜åˆ°äº‘ç«¯
        async function saveFavToCloud(fav) {
            if (!currentUid) return;
            const userDoc = doc(db, 'userFavs', currentUid);
            await setDoc(userDoc, { favs: arrayUnion(fav) }, { merge: true });
            favsCache.push(fav);
            renderFavs();
        }

        // åˆ é™¤äº‘ç«¯æ”¶è—
        async function removeFavFromCloud(idx) {
            if (!currentUid) return;
            const userDoc = doc(db, 'userFavs', currentUid);
            const favToRemove = favsCache[idx];
            await updateDoc(userDoc, { favs: arrayRemove(favToRemove) });
            favsCache.splice(idx, 1);
            renderFavs();
        }

        // æ˜¾ç¤ºç™»å½•å¼¹çª—
        window.showLoginModal = function () {
            document.getElementById('login-modal').style.display = 'flex';
        };

        // å…³é—­ç™»å½•å¼¹çª—
        window.closeLoginModal = function () {
            document.getElementById('login-modal').style.display = 'none';
            document.getElementById('login-email').value = '';
            document.getElementById('login-password').value = '';
        };

        // ç™»å½•äº‹ä»¶
        window.login = function () {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            signInWithEmailAndPassword(auth, email, password)
                .catch((error) => {
                    alert('ç™»å½•å¤±è´¥ï¼š' + error.message);
                });
        };

        // ç™»å‡ºäº‹ä»¶
        window.logout = function () {
            signOut(auth);
        };

        // åˆ‡æ¢ç¼–è¾‘æ¨¡å¼
        window.toggleCustomMode = function () {
            window.isCustomizing = !window.isCustomizing;
            renderFavs();
            // æŒ‰é’®æ–‡å­—åˆ‡æ¢
            var btn = document.getElementById('fav-custom-btn');
            if (btn) btn.innerHTML = window.isCustomizing ? '<span style="font-size:15px;">ğŸ’¾ ä¿å­˜</span>' : '<span style="font-size:15px;">âš™ï¸ç¼–è¾‘</span>';
        };

        // æ¸²æŸ“æ”¶è—
        window.renderFavs = function () {
            const list = document.getElementById('fav-list');
            list.innerHTML = '';

            // æ·»åŠ æ”¶è—å¡ç‰‡
            const addCard = document.createElement('div');
            addCard.id = 'fav-add-card';
            addCard.className = 'fav-card';
            addCard.innerHTML = '<svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" style="fill: #3385ff;width: 22px;margin-right: 10px;"><path d="M577.088 0H448.96v448.512H0v128h448.96V1024h128.128V576.512H1024v-128H577.088z"></path></svg><div style="color:#3385ff;">æ·»åŠ é“¾æ¥</div>';
            addCard.onclick = openFavForm;
            list.appendChild(addCard);

            // æ¸²æŸ“æ”¶è—å¡ç‰‡
            favsCache.forEach((fav, idx) => {
                const card = document.createElement('div');
                card.className = 'fav-card';
                card.innerHTML = `
    <a href="${fav.url}" target="_blank" class="fav-link">
      <img src="${fav.icon || 'https://ico.cxr.cool/' + (fav.url.replace(/^https?:\/\//, '').split('/')[0]) + '.ico'}" class="fav-icon" onerror="this.src='https://cdn.jsdmirror.com/gh/xiaolongmr/test@main/1.png';this.onerror=null;">
      <div class="fav-context"><div class="fav-title">${fav.title}</div>
      <div class="fav-desc">${fav.desc || ''}</div></div>
    </a>
    ${window.isCustomizing ? `<span onclick="removeFav(${idx})" class="fav-remove">Ã—</span>` : ''}
  `;
                list.appendChild(card);
            });
        };

        // åˆ é™¤æ”¶è—
        window.removeFav = function (idx) {
            removeFavFromCloud(idx);
        };

        // "+"åŠ å·å¡ç‰‡å¼¹çª—
        function openFavForm() {
            document.getElementById('fav-form-modal').style.display = 'flex';
        }

        window.closeFavForm = function () {
            document.getElementById('fav-form-modal').style.display = 'none';
            document.getElementById('fav-form-url').value = '';
            document.getElementById('fav-form-title').value = '';
            document.getElementById('fav-form-icon').value = '';
            document.getElementById('fav-form-desc').value = '';
        };

        // ä½¿ç”¨æ–°APIè·å–ç½‘ç«™ä¿¡æ¯
        window.autoGetIcon = async function () {
            const urlInput = document.getElementById('fav-form-url');
            const url = urlInput.value.trim();

            if (!url) {
                alert('è¯·å…ˆå¡«å†™ç½‘å€');
                return;
            }

            // ç¡®ä¿URLåŒ…å«åè®®å¤´
            let fullUrl = url;
            if (!url.startsWith('http://') && !url.startsWith('https://')) {
                fullUrl = 'https://' + url;
                urlInput.value = fullUrl;
            }

            try {
                // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
                document.getElementById('fav-form-title').value = 'åŠ è½½ä¸­...';
                document.getElementById('fav-form-icon').value = '';
                document.getElementById('fav-form-desc').value = '';

                // è°ƒç”¨æ–°API
                const response = await fetch('https://v.api.aa1.cn/api/api-web-head-json/index.php?url=' + encodeURIComponent(fullUrl));
                const data = await response.json();

                if (data && data.code === 200) {
                    // å¡«å……è¡¨å•
                    document.getElementById('fav-form-title').value = data.title || '';
                    document.getElementById('fav-form-icon').value = 'https://ico.cxr.cool/' + (data.url.replace(/^https?:\/\//, '').split('/')[0]) + '.ico';
                    document.getElementById('fav-form-desc').value = data.description || '';
                } else {
                    alert('è·å–ç½‘ç«™ä¿¡æ¯å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¡«å†™');
                    document.getElementById('fav-form-title').value = '';
                }
            } catch (error) {
                console.error('è·å–ç½‘ç«™ä¿¡æ¯å‡ºé”™:', error);
                alert('è·å–ç½‘ç«™ä¿¡æ¯å‡ºé”™ï¼Œè¯·æ‰‹åŠ¨å¡«å†™');
                document.getElementById('fav-form-title').value = '';
            }
        };

        window.submitFavForm = async function () {
            const url = document.getElementById('fav-form-url').value.trim();
            const title = document.getElementById('fav-form-title').value.trim();
            const icon = document.getElementById('fav-form-icon').value.trim();
            const desc = document.getElementById('fav-form-desc').value.trim();

            if (!url || !title) {
                alert('è¯·å¡«å†™å®Œæ•´ä¿¡æ¯');
                return;
            }

            const fav = { title, url, icon, desc };
            await saveFavToCloud(fav);
            closeFavForm();
        };

        // "è‡ªå®šä¹‰"æŒ‰é’®å¼¹çª—
        window.openSelectSiteModal = function () {
            document.getElementById('select-site-modal').style.display = 'flex';
            renderSiteList();
        };

        window.closeSelectSiteModal = function () {
            document.getElementById('select-site-modal').style.display = 'none';
        };

        // æ¸²æŸ“ç«™ç‚¹åˆ—è¡¨
        window.renderSiteList = function () {
            const siteList = document.getElementById('site-list');
            siteList.innerHTML = '';

            // æ„å»ºäºŒçº§åˆ†ç»„ç»“æ„ {å¤§ç±»: {å°ç±»: [site, ...]}}
            const groupMap = {};
            (window.allSites || []).forEach(site => {
                const main = site.group ? site.group.split('>')[0].trim() : 'æœªåˆ†ç»„';
                const sub = site.group && site.group.includes('>') ? site.group.split('>')[1].trim() : '';
                if (!groupMap[main]) groupMap[main] = {};
                if (!groupMap[main][sub]) groupMap[main][sub] = [];
                groupMap[main][sub].push(site);
            });

            const mains = Object.keys(groupMap);

            // ä¸€çº§Tab
            const tabBarMain = document.createElement('div');
            tabBarMain.className = 'tab-bar tab-bar-main';
            tabBarMain.style = 'display:flex;gap:8px;overflow-x:auto;margin-bottom:8px;padding-bottom:4px;';

            mains.forEach((main, i) => {
                const tab = document.createElement('button');
                tab.innerText = main;
                tab.className = 'tab-btn' + (i === 0 ? ' active' : '');
                tab.onclick = function () {
                    document.querySelectorAll('#site-list .tab-bar-main .tab-btn').forEach(btn => btn.classList.remove('active'));
                    tab.classList.add('active');
                    document.querySelectorAll('#site-list .tab-bar-sub').forEach(c => c.style.display = 'none');
                    document.getElementById('tab-bar-sub-' + i).style.display = 'flex';

                    // é»˜è®¤æ¿€æ´»ç¬¬ä¸€ä¸ªäºŒçº§tab
                    const firstSub = document.getElementById('tab-bar-sub-' + i).querySelector('.tab-btn');
                    if (firstSub) firstSub.click();
                };
                tabBarMain.appendChild(tab);
            });

            siteList.appendChild(tabBarMain);

            // äºŒçº§Tabå’Œå†…å®¹
            mains.forEach((main, i) => {
                const subs = Object.keys(groupMap[main]);
                const tabBarSub = document.createElement('div');
                tabBarSub.className = 'tab-bar tab-bar-sub';
                tabBarSub.id = 'tab-bar-sub-' + i;
                tabBarSub.style = 'display:' + (i === 0 ? 'flex' : 'none') + ';gap:8px;overflow-x:auto;margin-bottom:12px;';

                subs.forEach((sub, j) => {
                    const tab = document.createElement('button');
                    tab.innerText = sub || main;
                    tab.className = 'tab-btn' + (j === 0 ? ' active' : '');
                    tab.onclick = function () {
                        document.querySelectorAll('#tab-bar-sub-' + i + ' .tab-btn').forEach(btn => btn.classList.remove('active'));
                        tab.classList.add('active');
                        document.querySelectorAll('#site-list .site-list-content').forEach(c => c.style.display = 'none');
                        document.getElementById('site-list-content-' + i + '-' + j).style.display = 'flex';
                    };
                    tabBarSub.appendChild(tab);
                });

                siteList.appendChild(tabBarSub);

                // å†…å®¹åŒº
                subs.forEach((sub, j) => {
                    const content = document.createElement('div');
                    content.className = 'site-list site-list-content';
                    content.id = 'site-list-content-' + i + '-' + j;
                    content.style = 'flex-wrap:wrap;gap:16px;' + (j === 0 && i === 0 ? 'display:flex;' : 'display:none;');

                    groupMap[main][sub].forEach((site, idx) => {
                        const card = document.createElement('div');
                        card.className = 'site-card';
                        card.innerHTML = `<input type="checkbox" value="${window.allSites.indexOf(site)}" style="margin-right:8px;">
                      <span>${site.title}</span>
                      <small>${site.url}</small>`;
                        content.appendChild(card);
                    });

                    siteList.appendChild(content);
                });
            });
        };

        window.addSelectedSitesToFav = async function () {
            const checked = Array.from(document.querySelectorAll('#site-list input[type=checkbox]:checked'));
            if (!checked.length) { alert('è¯·é€‰æ‹©è¦æ·»åŠ çš„ç«™ç‚¹'); return; }

            let added = 0;
            for (const cb of checked) {
                const site = window.allSites[cb.value];
                if (favsCache.some(f => f.url === site.url)) continue; // å·²æœ‰åˆ™è·³è¿‡

                await saveFavToCloud(site);
                added++;
            }

            if (added === 0) alert('æ‰€é€‰ç«™ç‚¹å‡å·²æ”¶è—ï¼Œæ— éœ€é‡å¤æ·»åŠ ï¼');
            closeSelectSiteModal();
        };

        // ExcelåŠ è½½åè‡ªåŠ¨ç”Ÿæˆwindow.allSites
        window.allSites = [];
        function collectAllSitesFromExcel() {
            try {
                const mainContent = document.getElementById('excel');
                const cards = mainContent.querySelectorAll('.box-card');
                let sites = [];

                cards.forEach(card => {
                    const items = card.querySelectorAll('a');
                    items.forEach(a => {
                        const title = a.querySelector('.logo span') ? a.querySelector('.logo span').textContent.trim() : '';
                        const url = a.href;
                        const icon = a.querySelector('img') ? a.querySelector('img').src : '';
                        const desc = a.querySelector('.desc') ? a.querySelector('.desc').textContent.trim() : '';

                        // åˆ†ç»„å¯ç”¨çˆ¶çº§h2æˆ–boxæ ‡é¢˜
                        let group = '';
                        let parent = a.closest('.box');
                        if (parent) {
                            let h2 = parent.querySelector('h2');
                            if (h2) group = h2.textContent.trim();
                        }

                        sites.push({ title, url, icon, group, desc });
                    });
                });

                window.allSites = sites;
            } catch (e) {
                window.allSites = [];
                console.error('æ”¶é›†ç«™ç‚¹æ•°æ®å¤±è´¥:', e);
            }
        }

        // ä¼˜åŒ–æ‰¹é‡æ·»åŠ å¼¹çª—æ ·å¼
        (function () {
            var style = document.createElement('style');
            style.innerHTML = `
            #select-site-modal .tab-bar { gap: 4px !important; overflow-x: auto !important; padding-bottom: 2px !important; }
            #select-site-modal .tab-btn { font-size: 13px !important; padding: 3px 10px !important; border-radius: 14px !important; border: none; background: #f0f4ff; color: #3273dc; margin-right: 2px; white-space: nowrap; }
            #select-site-modal .tab-btn.active { background: #3385ff; color: #fff; }
            #select-site-modal .site-list-content { display: flex; flex-wrap: wrap; gap: 12px; }
            #select-site-modal .site-card { background: #fff; border-radius: 8px; box-shadow: 0 2px 8px #e0e7ef; padding: 10px 8px; min-width: 0; max-width: 320px; width: 30%; display: flex; flex-direction: column; align-items: flex-start; gap: 2px; font-size: 14px; word-break: break-all; }
            #select-site-modal .site-card span { font-weight: bold; font-size: 14px; margin-bottom: 2px; word-break: break-all; }
            #select-site-modal .site-card small { color: #888; font-size: 12px; margin-top: 2px; }
            @media (max-width: 800px) { 
                #select-site-modal .site-list-content { flex-direction: column; gap: 8px; } 
                #select-site-modal .site-card { width: 100%; font-size: 13px; padding: 8px 6px; } 
            }
        `;
            document.head.appendChild(style);
        })();

        // ç»‘å®šæŒ‰é’®äº‹ä»¶
        document.addEventListener('DOMContentLoaded', function () {
            // ç»‘å®šæ·»åŠ æŒ‰é’®
            var addBtn = document.getElementById('fav-add-card');
            if (addBtn) addBtn.onclick = openFavForm;

            // ç»‘å®šè‡ªå®šä¹‰æŒ‰é’®
            var customBtn = document.getElementById('fav-custom-btn');
            if (customBtn) customBtn.onclick = window.toggleCustomMode;

            // ç»‘å®šæ‰¹é‡æ·»åŠ æŒ‰é’®
            var batchBtn = document.getElementById('fav-batch-add-btn');
            if (batchBtn) batchBtn.onclick = window.openSelectSiteModal;

            // æ”¶é›†æ‰€æœ‰ç«™ç‚¹æ•°æ®
            setTimeout(collectAllSitesFromExcel, 1500); // Excelå¼‚æ­¥åŠ è½½ï¼Œå»¶è¿Ÿæ”¶é›†
        });
    </script>



</body>

</html>